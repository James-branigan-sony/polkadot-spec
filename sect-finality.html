<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-sect-finality">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v0.0.0-5547">
<title data-rh="true">6. Finality | Polkadot Protocol Specification</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://spec.polkadot.network/sect-finality"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="6. Finality | Polkadot Protocol Specification"><meta data-rh="true" name="description" content="6.1. Introduction"><meta data-rh="true" property="og:description" content="6.1. Introduction"><link data-rh="true" rel="icon" href="/img/polkadot-logo.png"><link data-rh="true" rel="canonical" href="https://spec.polkadot.network/sect-finality"><link data-rh="true" rel="alternate" href="https://spec.polkadot.network/sect-finality" hreflang="en"><link data-rh="true" rel="alternate" href="https://spec.polkadot.network/sect-finality" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://59CYO0AR6V-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css"><link rel="stylesheet" href="/assets/css/styles.e5183a90.css">
<script src="/assets/js/runtime~main.6f1f5099.js" defer="defer"></script>
<script src="/assets/js/main.b77e0a44.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Polkadot_Logo_Horizontal_Pink-Black.svg" alt="Polkadot Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/Polkadot_Logo_Horizontal_Pink-Black.svg" alt="Polkadot Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/part-polkadot-host">Host</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/part-polkadot-runtime">Runtime</a><a href="https://github.com/w3f/polkadot-spec" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/id-polkadot-protocol">Protocol</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/part-polkadot-host">Host</a><button aria-label="Toggle the collapsible sidebar category &#x27;Host&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/chap-overview">1. Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/chap-state">2. States and Transitions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/chap-sync">3. Synchronization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/chap-networking">4. Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sect-block-production">5. Block Production</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/sect-finality">6. Finality</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sect-lightclient">7. Light Clients</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/chapter-anv">8. Availability &amp; Validity</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/part-polkadot-runtime">Runtime</a><button aria-label="Toggle the collapsible sidebar category &#x27;Runtime&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/id-extrinsics">9. Extrinsics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/id-weights">10. Weights</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/id-consensus">11. Consensus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sect-metadata">12. Metadata</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/Implementation Guide">Implementation Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Implementation Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Implementation Guide/faq">FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/id-cryptography-encoding">Appendix A: Cryptography &amp; Encoding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chap-host-api">Appendix B: Host API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chap-runtime-api">Appendix C: Runtime API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/id-glossary">Glossary</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/part-polkadot-host"><span itemprop="name">Host</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">6. Finality</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>6. Finality</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="id-introduction-4">6.1. Introduction<a href="#id-introduction-4" class="hash-link" aria-label="Direct link to 6.1. Introduction" title="Direct link to 6.1. Introduction">​</a></h2><p>The Polkadot Host uses GRANDPA Finality protocol to finalize blocks. Finality is obtained by consecutive rounds of voting by the validator nodes. Validators execute GRANDPA finality process in parallel to Block Production as an independent service. In this section, we describe the different functions that GRANDPA service performs to successfully participate in the block-finalization process.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-grandpa-voter">Definition 77. GRANDPA Voter<a href="#defn-grandpa-voter" class="hash-link" aria-label="Direct link to Definition 77. GRANDPA Voter" title="Direct link to Definition 77. GRANDPA Voter">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>A <strong>GRANDPA Voter</strong>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span>, represented by a key pair <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><msubsup><mi>K</mi><mi>v</mi><mtext>pr</mtext></msubsup><mo separator="true">,</mo><msub><mi>v</mi><mtext>id</mtext></msub><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">{\left({{K}_{{v}}^{{\text{pr}}}},{v}_{{\text{id}}}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">pr</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">id</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>k</mi><mi>v</mi><mtext>pr</mtext></msubsup></mrow><annotation encoding="application/x-tex">{{k}_{{v}}^{{\text{pr}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9414em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">pr</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span> represents an <em>ed25519</em> private key, is a node running a GRANDPA protocol and broadcasting votes to finalize blocks in a Polkadot Host-based chain. The <strong>set of all GRANDPA voters</strong> for a given block B is indicated by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">V</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbb{{V}}}_{{B}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>. In that regard, we have <!-- -->[<!-- -->To do: change function name, only call at genesis, adjust V_B over the sections<!-- -->]</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="double-struck">V</mi><mo>=</mo><mrow><mi mathvariant="monospace">g</mi><mi mathvariant="monospace">r</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">n</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">p</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">_</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">u</mi><mi mathvariant="monospace">t</mi><mi mathvariant="monospace">h</mi><mi mathvariant="monospace">o</mi><mi mathvariant="monospace">r</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">t</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">e</mi><mi mathvariant="monospace">s</mi></mrow><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\mathbb{{V}}}={\tt{grandpa\_authorities}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathtt">grandpa_authorities</span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span></div><p>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">g</mi><mi mathvariant="monospace">r</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">n</mi><mi mathvariant="monospace">d</mi><mi mathvariant="monospace">p</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">_</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">u</mi><mi mathvariant="monospace">t</mi><mi mathvariant="monospace">h</mi><mi mathvariant="monospace">o</mi><mi mathvariant="monospace">r</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">t</mi><mi mathvariant="monospace">i</mi><mi mathvariant="monospace">e</mi><mi mathvariant="monospace">s</mi></mrow><annotation encoding="application/x-tex">{\tt{grandpa\_authorities}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.2222em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathtt">grandpa_authorities</span></span></span></span></span></span></span></span> is a function entry point of the Runtime described in <a href="/chap-runtime-api#sect-rte-grandpa-auth">Section C.10.1.</a>. We refer to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">V</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbb{{V}}}_{{B}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> as <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">V</mi></mrow><annotation encoding="application/x-tex">{\mathbb{{V}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span></span></span></span></span> when there is no chance of ambiguity.</p><p>Analogously, we say that a Polkadot node is a <strong>non-voter node</strong> for block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> if it does not own any of the key pairs in <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">V</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbb{{V}}}_{{B}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-authority-set-id">Definition 78. Authority Set Id<a href="#defn-authority-set-id" class="hash-link" aria-label="Direct link to Definition 78. Authority Set Id" title="Direct link to Definition 78. Authority Set Id">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>The <strong>authority set Id</strong> (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub></mrow><annotation encoding="application/x-tex">\text{id}_{{{\mathbb{{V}}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>) is an incremental counter which tracks the amount of authority list changes that occurred (<a href="/sect-finality#defn-consensus-message-grandpa">Definition 91</a>). Starting with the value of zero at genesis, the Polkadot Host increments this value by one every time a <strong>Scheduled Change</strong> or a <strong>Forced Change</strong> occurs. The authority set ID is an unsigned 64-bit integer.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-grandpa-state">Definition 79. GRANDPA State<a href="#defn-grandpa-state" class="hash-link" aria-label="Direct link to Definition 79. GRANDPA State" title="Direct link to Definition 79. GRANDPA State">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>The <strong>GRANDPA state</strong>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>GS</mtext></mrow><annotation encoding="application/x-tex">\text{GS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text"><span class="mord">GS</span></span></span></span></span></span>, is defined as:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>GS</mtext><mtext> </mtext><mo>=</mo><mrow><mo fence="true">{</mo><mi mathvariant="double-struck">V</mi><mo separator="true">,</mo><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub><mo separator="true">,</mo><mi>r</mi><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\text{GS}\:={\left\lbrace{\mathbb{{V}}},\text{id}_{{{\mathbb{{V}}}}},{r}\right\rbrace}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text"><span class="mord">GS</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">{</span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mclose delimcenter" style="top:0em">}</span></span></span></span></span></span></span></div><p><strong>where</strong>  </p><ul><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">V</mi></mrow><annotation encoding="application/x-tex">{\mathbb{{V}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span></span></span></span></span>: is the set of voters.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub></mrow><annotation encoding="application/x-tex">\text{id}_{{{\mathbb{{V}}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>: is the authority set ID (<a href="/sect-finality#defn-authority-set-id">Definition 78</a>).</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span>: is the voting round number.</p></li></ul></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-vote">Definition 80. GRANDPA Vote<a href="#defn-vote" class="hash-link" aria-label="Direct link to Definition 80. GRANDPA Vote" title="Direct link to Definition 80. GRANDPA Vote">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>A <strong>GRANDPA vote</strong> or simply a vote for block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> is an ordered pair defined as</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>V</mi><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mtext> </mtext><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>H</mi><mi>h</mi></msub><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><msub><mi>H</mi><mi>i</mi></msub><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{V}{\left({B}\right)}\:={\left({H}_{{h}}{\left({B}\right)},{H}_{{i}}{\left({B}\right)}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span></div><p>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>h</mi></msub><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{H}_{{h}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{H}_{{i}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> are the block hash (<a href="/chap-state#defn-block-header-hash">Definition 12</a>) and the block number (<a href="/chap-state#defn-block-header">Definition 10</a>).</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-voting-rounds">Definition 81. Voting Rounds<a href="#defn-voting-rounds" class="hash-link" aria-label="Direct link to Definition 81. Voting Rounds" title="Direct link to Definition 81. Voting Rounds">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>Voters engage in a maximum of two sub-rounds of voting for each round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span>. The first sub-round is called <strong>pre-vote</strong>, and the second is called <strong>pre-commit</strong>. </p><p>By <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pv</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{V}_{{v}}^{{{r},\text{pv}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9303em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pv</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{V}_{{v}}^{{{r},\text{pc}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9303em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span> we refer to the vote cast by voter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> in round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> (for block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span>) during the pre-vote and the pre-commit sub-round respectively.</p><p>Voting is done by means of broadcasting voting messages (<a href="/chap-networking#sect-msg-grandpa">Section 4.8.7.</a>) to the network. Validators inform their peers about the block finalized in round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> by broadcasting a commit message (<a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a>).</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-sign-round-vote">Definition 82. Vote Signature<a href="#defn-sign-round-vote" class="hash-link" aria-label="Direct link to Definition 82. Vote Signature" title="Direct link to Definition 82. Vote Signature">​</a></h6><div class="alert alert--definition"><h5></h5><div><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext>Sign</mtext><msub><mi>v</mi><mi>i</mi></msub><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{\text{Sign}_{{{v}_{{i}}}}^{{{r},\text{stage}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2139em;vertical-align:-0.3471em"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">Sign</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8668em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.1362em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em"><span></span></span></span></span></span></span></span></span></span></span></span> refers to the signature of a voter for a specific message in a round and is formally defined as:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mtext>Sign</mtext><msub><mi>v</mi><mi>i</mi></msub><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mtext> </mtext><mo>=</mo><msub><mtext>Sig</mtext><mtext>ed25519</mtext></msub><mrow><mo fence="true">(</mo><mtext>msg</mtext><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\text{Sign}_{{{v}_{{i}}}}^{{{r},\text{stage}}}}\:=\text{Sig}_{{\text{ed25519}}}{\left(\text{msg},{r},\text{id}_{{{\mathbb{{V}}}}}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2139em;vertical-align:-0.3471em"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">Sign</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8668em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.1362em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord text"><span class="mord">Sig</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.242em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ed25519</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord text"><span class="mord">msg</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span></div><p><strong>where</strong>  </p><ul><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>msg</mtext></mrow><annotation encoding="application/x-tex">\text{msg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">msg</span></span></span></span></span></span>: is a byte array containing the message to be signed (<a href="/sect-finality#defn-vote">Definition 80</a>).</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span>: is an unsigned 64-bit integer is the round number.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub></mrow><annotation encoding="application/x-tex">\text{id}_{{{\mathbb{{V}}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>: is an unsigned 64-bit integer indicating the authority set Id (<a href="/sect-finality#defn-authority-set-id">Definition 78</a>).</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>stage</mtext></mrow><annotation encoding="application/x-tex">\text{stage}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">stage</span></span></span></span></span></span>: is either the <strong>pre-vote</strong> (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>t</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo>=</mo><mi>p</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">{stage = pv}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span>) or the <strong>pre-commit</strong> (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>t</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo>=</mo><mi>p</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">{stage = pc}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">c</span></span></span></span></span></span>) sub-round of voting <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span>, as defined in (<a href="/sect-finality#defn-voting-rounds">Definition 81</a>).</p></li></ul></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-grandpa-justification">Definition 83. Justification<a href="#defn-grandpa-justification" class="hash-link" aria-label="Direct link to Definition 83. Justification" title="Direct link to Definition 83. Justification">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>The <strong>justification</strong> for block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> in round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>J</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{J}^{{{r},\text{stage}}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span>, is a vector of pairs of the type:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">(</mo><mi>V</mi><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo separator="true">,</mo><msubsup><mtext>Sign</mtext><msub><mi>v</mi><mi>i</mi></msub><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo separator="true">,</mo><msub><mi>v</mi><mtext>id</mtext></msub><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">{\left({V}{\left({B}&#x27;\right)},{\text{Sign}_{{{v}_{{i}}}}^{{{r},\text{stage}}}}{\left({B}&#x27;\right)},{v}_{{\text{id}}}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2168em;vertical-align:-0.35em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">Sign</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8668em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.1362em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">id</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span></span></span></span></span></span></div><p>in which either</p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≥</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}&#x27;\ge{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879em;vertical-align:-0.136em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span></p><p>or <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><msub><mi>v</mi><mi>i</mi></msub><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{V}_{{{v}_{{i}}}}^{{{r},\text{pc}}}}{\left({B}&#x27;\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099em;vertical-align:-0.3471em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> is an equivocatory vote.</p><p>In all cases, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext>Sign</mtext><msub><mi>v</mi><mi>i</mi></msub><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\text{Sign}_{{{v}_{{i}}}}^{{{r},\text{stage}}}}{\left({B}&#x27;\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2139em;vertical-align:-0.3471em"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">Sign</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8668em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.1362em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> is the signature (<a href="/sect-finality#defn-sign-round-vote">Definition 82</a>) of voter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mtext>id</mtext></msub><mo>∈</mo><msub><mi mathvariant="double-struck">V</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">{v}_{{\text{id}}}\in{\mathbb{{V}}}_{{B}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">id</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> broadcasted during a specific <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>t</mi><mi>a</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">{stage}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">e</span></span></span></span></span></span> (i.e., sub-round)(<a href="/sect-finality#defn-voting-rounds">Definition 81</a>) of round r. A <strong>valid justification</strong> must only contain up to one valid vote from each voter and must not contain more than two equivocatory votes from each voter.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-finalizing-justification">Definition 84. Finalizing Justification<a href="#defn-finalizing-justification" class="hash-link" aria-label="Direct link to Definition 84. Finalizing Justification" title="Direct link to Definition 84. Finalizing Justification">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>We say <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>J</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{J}^{{{r},\text{pc}}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> <strong>justifies the finalization</strong> of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≥</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}&#x27;\ge{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879em;vertical-align:-0.136em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> <strong>for a non-voter node</strong> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span></span></span> if the number of valid signatures in <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>J</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{J}^{{{r},\text{pc}}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">{B}&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is greater than <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>2</mn><mn>3</mn></mfrac><mrow><mo fence="true">∣</mo><msub><mi mathvariant="double-struck">V</mi><mi>B</mi></msub><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">\frac{{2}}{{3}}{\left|{\mathbb{{V}}}_{{B}}\right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">∣</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">∣</span></span></span></span></span></span></span>.</p><p>Note that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>J</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{J}^{{{r},\text{pc}}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> can only be used by a non-voter node to finalize a block. In contrast, a voter node can only be assured of the finality (<a href="/sect-finality#defn-finalized-block">Definition 94</a>) of block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> by actively participating in the voting process. That is by invoking <a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a>.</p><p>The GRANDPA protocol dictates how an honest voter should vote in each sub-round, which is described by <a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a>. After defining what constitutes a vote in GRANDPA, we define how GRANDPA counts votes.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-voter-equivocation">Definition 85. Equivocation<a href="#defn-voter-equivocation" class="hash-link" aria-label="Direct link to Definition 85. Equivocation" title="Direct link to Definition 85. Equivocation">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>Voter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> <strong>equivocates</strong> if they broadcast two or more valid votes to blocks during one voting sub-round. In such a situation, we say that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> is an <strong>equivocator</strong> and any vote <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{V}_{{v}}^{{{r},\text{stage}}}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> cast by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> in that sub-round is an <strong>equivocatory vote</strong>, and</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi mathvariant="script">E</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathcal{{E}}}^{{{r},\text{stage}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8436em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em">E</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8436em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></div><p>represents the set of all equivocators voters in sub-round <em>stage</em> of round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span>. When we want to refer to the number of equivocators whose equivocation has been observed by voter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span>, we refer to it by:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi mathvariant="script">E</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{\mathcal{{E}}}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4267em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em">E</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span></span></span></span></span></div><p>The Polkadot Host must detect equivocations committed by other validators and submit those to the Runtime as described in <a href="/chap-runtime-api#sect-grandpaapi_submit_report_equivocation_unsigned_extrinsic">Section C.10.3.</a>.</p><p>A vote <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mo>=</mo><mi>V</mi><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{V}_{{v}}^{{{r},\text{stage}}}}={V}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0406em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> is <strong>invalid</strong> if</p><ul><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{H}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> does not correspond to a valid block.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> is not an (eventual) descendant of a previously finalized block.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>M</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{M}_{{v}}^{{{r},\text{stage}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0406em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span> does not bear a valid signature.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub></mrow><annotation encoding="application/x-tex">\text{id}_{{{\mathbb{{V}}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> does no match the current <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">V</mi></mrow><annotation encoding="application/x-tex">{\mathbb{{V}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span></span></span></span></span>.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{V}_{{v}}^{{{r},\text{stage}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0406em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span> is an equivocatory vote.</p></li></ul></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-observed-direct-votes">Definition 86. Set of Observed Direct Votes<a href="#defn-observed-direct-votes" class="hash-link" aria-label="Direct link to Definition 86. Set of Observed Direct Votes" title="Direct link to Definition 86. Set of Observed Direct Votes">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>For validator <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span>, <strong>the set of observed direct votes for Block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> in round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span></strong>, formally denoted by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mtext>VD</mtext><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\text{VD}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4267em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">VD</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> is equal to the union of:</p><ul><li>set of <em>valid</em> votes <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><msub><mi>v</mi><mi>i</mi></msub><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{V}_{{{v}_{{i}}}}^{{{r},\text{stage}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1407em;vertical-align:-0.3471em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em"><span></span></span></span></span></span></span></span></span></span></span></span> cast in round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> and received by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> such that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><msub><mi>v</mi><mi>i</mi></msub><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mo>=</mo><mi>V</mi><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{V}_{{{v}_{{i}}}}^{{{r},\text{stage}}}}={V}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1407em;vertical-align:-0.3471em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3471em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span>.</li></ul></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-observed-votes">Definition 87. Set of Total Observed Votes<a href="#defn-observed-votes" class="hash-link" aria-label="Direct link to Definition 87. Set of Total Observed Votes" title="Direct link to Definition 87. Set of Total Observed Votes">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>We refer to <strong>the set of total votes observed by voter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> in sub-round <em>stage</em> of round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span></strong> by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4267em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span></span></span></span></span>.</p><p>The <strong>set of all observed votes by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> in the sub-round stage of round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> for block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span></strong>, <strong><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4267em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span></span></span></span></span></strong> is equal to all of the observed direct votes cast for block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> and all of the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span>’s descendants defined formally as:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mtext> </mtext><mo>=</mo><munder><mo>⋃</mo><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>∈</mo><mi mathvariant="double-struck">V</mi><mo separator="true">,</mo><mi>B</mi><mo>&lt;</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></munder><msubsup><mtext>VD</mtext><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}{\left({B}\right)}\:=\bigcup_{{{v}_{{i}}\in{\mathbb{{V}}},{B}&lt;{B}&#x27;}}{\text{VD}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}{\left({B}&#x27;\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4267em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.4843em;vertical-align:-1.4343em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8518em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span><span class="mrel mtight">&lt;</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">⋃</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4343em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">VD</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span></div><p>The <strong>total number of observed votes for Block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> in round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span></strong> is defined to be the size of that set plus the total number of equivocator voters:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mtext> </mtext><mo>=</mo><mrow><mo fence="true">∣</mo><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow><mo>+</mo><mrow><mo fence="true">∣</mo><msubsup><mi mathvariant="script">E</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}{\left({B}\right)}\:={\left|{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}{\left({B}\right)}\right|}+{\left|{{\mathcal{{E}}}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}\right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4267em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.812em;vertical-align:-0.65em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.812em;vertical-align:-0.65em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em">E</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span></span></span></span></span></div><p>Note that for genesis state we always have <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">#</mi><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pv</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">∣</mo><mi mathvariant="double-struck">V</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">\#{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{pv}}}}{\left({B}\right)}={\left|{\mathbb{{V}}}\right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2975em;vertical-align:-0.5152em"></span><span class="mord">#</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pv</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">∣</span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="mclose delimcenter" style="top:0em">∣</span></span></span></span></span></span></span>.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-total-potential-votes">Definition 88. Set of Total Potential Votes<a href="#defn-total-potential-votes" class="hash-link" aria-label="Direct link to Definition 88. Set of Total Potential Votes" title="Direct link to Definition 88. Set of Total Potential Votes">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>Let <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mrow><mtext>unobs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{V}_{{\text{unobs}{\left({v}\right)}}}^{{{r},\text{stage}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4267em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">unobs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span></span></span></span></span> be the set of voters whose vote in the given stage has not been received. We define the <strong>total number of potential votes for Block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> in round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span></strong> to be:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">#</mi><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mtext>pot</mtext></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mtext> </mtext><mo>=</mo><mrow><mo fence="true">∣</mo><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow><mo>+</mo><mrow><mo fence="true">∣</mo><msubsup><mi>V</mi><mrow><mtext>unobs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mo fence="true">∣</mo></mrow><mo>+</mo><mtext>Min</mtext><mrow><mo fence="true">(</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><mrow><mo fence="true">∣</mo><mi mathvariant="double-struck">V</mi><mo fence="true">∣</mo></mrow><mo separator="true">,</mo><mrow><mo fence="true">∣</mo><mi mathvariant="double-struck">V</mi><mo fence="true">∣</mo></mrow><mo>−</mo><mrow><mo fence="true">∣</mo><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow><mo>−</mo><mrow><mo fence="true">∣</mo><msubsup><mi>V</mi><mrow><mtext>unobs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mo fence="true">∣</mo></mrow><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\#{{V}_{{\text{obs}{\left({v}\right)},\text{pot}}}^{{{r},\text{stage}}}}{\left({B}\right)}\:={\left|{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}{\left({B}\right)}\right|}+{\left|{{V}_{{\text{unobs}{\left({v}\right)}}}^{{{r},\text{stage}}}}\right|}+\text{Min}{\left(\frac{{1}}{{3}}{\left|{\mathbb{{V}}}\right|},{\left|{\mathbb{{V}}}\right|}-{\left|{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{stage}}}}{\left({B}\right)}\right|}-{\left|{{V}_{{\text{unobs}{\left({v}\right)}}}^{{{r},\text{stage}}}}\right|}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4267em;vertical-align:-0.5152em"></span><span class="mord">#</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pot</span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.812em;vertical-align:-0.65em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.812em;vertical-align:-0.65em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">unobs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em"></span><span class="mord text"><span class="mord">Min</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">∣</span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="mclose delimcenter" style="top:0em">∣</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">∣</span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="mclose delimcenter" style="top:0em">∣</span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">unobs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">)</span></span></span></span></span></span></span></span></div></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-grandpa-ghost">Definition 89. Current Pre-Voted Block<a href="#defn-grandpa-ghost" class="hash-link" aria-label="Direct link to Definition 89. Current Pre-Voted Block" title="Direct link to Definition 89. Current Pre-Voted Block">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>The current <strong>pre-voted</strong> block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>B</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pv</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{B}_{{v}}^{{{r},\text{pv}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9303em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pv</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span> also known as GRANDPA GHOST is the block chosen by <a href="/sect-finality#algo-grandpa-ghost">GRANDPA-GHOST</a>:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>B</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pv</mtext></mrow></msubsup><mtext> </mtext><mo>=</mo><mtext>GRANDPA-GHOST</mtext><mrow><mo fence="true">(</mo><mi>r</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{B}_{{v}}^{{{r},\text{pv}}}}\:=\text{GRANDPA-GHOST}{\left({r}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9614em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pv</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">GRANDPA-GHOST</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span></div><p>Finally, we define when a voter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> sees a round as completable, that is, when they are confident that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>B</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pv</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{{B}_{{v}}^{{{r},\text{pv}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9303em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pv</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span> is an upper bound for what is going to be finalized in this round.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-grandpa-completable">Definition 90. Completable Round<a href="#defn-grandpa-completable" class="hash-link" aria-label="Direct link to Definition 90. Completable Round" title="Direct link to Definition 90. Completable Round">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>We say that round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> is <strong>completable</strong> if <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">∣</mo><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msubsup><mo fence="true">∣</mo></mrow><mo>+</mo><msubsup><mi mathvariant="script">E</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msubsup><mo>&gt;</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi mathvariant="double-struck">V</mi></mrow><annotation encoding="application/x-tex">{\left|{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{pc}}}}\right|}+{{\mathcal{{E}}}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{pc}}}}&gt;\frac{{2}}{{3}}{\mathbb{{V}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.812em;vertical-align:-0.65em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2975em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em">E</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span></span></span></span></span> and for all <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>&gt;</mo><msubsup><mi>B</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pv</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{B}&#x27;&gt;{{B}_{{v}}^{{{r},\text{pv}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.791em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9303em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pv</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span>:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">∣</mo><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msubsup><mo fence="true">∣</mo></mrow><mo>−</mo><msubsup><mi mathvariant="script">E</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msubsup><mo>−</mo><mrow><mo fence="true">∣</mo><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow><mo>&gt;</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mrow><mo fence="true">∣</mo><mi mathvariant="double-struck">V</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">{\left|{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{pc}}}}\right|}-{{\mathcal{{E}}}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{pc}}}}-{\left|{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{pc}}}}{\left({B}&#x27;\right)}\right|}&gt;\frac{{2}}{{3}}{\left|{\mathbb{{V}}}\right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.812em;vertical-align:-0.65em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2975em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em">E</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.812em;vertical-align:-0.65em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">3</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">∣</span><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="mclose delimcenter" style="top:0em">∣</span></span></span></span></span></span></span></div><p>Note that in practice we only need to check the inequality for those <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>&gt;</mo><msubsup><mi>B</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pv</mtext></mrow></msubsup></mrow><annotation encoding="application/x-tex">{B}&#x27;&gt;{{B}_{{v}}^{{{r},\text{pv}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.791em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9303em;vertical-align:-0.247em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pv</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span></span></span></span></span> where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">∣</mo><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{\left|{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},\text{pc}}}}{\left({B}&#x27;\right)}\right|}&gt;{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.812em;vertical-align:-0.65em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.162em"><span style="top:-1.966em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.564em"><span class="pstrut" style="height:2.616em"></span><span style="height:0.616em;width:0.3333em"><svg xmlns="http://www.w3.org/2000/svg" width="0.3333em" height="0.616em" style="width:0.3333em" viewBox="0 0 333.33000000000004 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span style="top:-3.172em"><span class="pstrut" style="height:2.616em"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em"><span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord"><span class="mord">0</span></span></span></span></span></span>.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-consensus-message-grandpa">Definition 91. GRANDPA Consensus Message<a href="#defn-consensus-message-grandpa" class="hash-link" aria-label="Direct link to Definition 91. GRANDPA Consensus Message" title="Direct link to Definition 91. GRANDPA Consensus Message">​</a></h6><div class="alert alert--definition"><h5></h5><div><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>CM</mtext><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">\text{CM}_{{g}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord text"><span class="mord">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">g</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span>, the consensus message for GRANDPA, is of the following format:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>CM</mtext><mi>g</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo fence="true">(</mo><msub><mtext>Auth</mtext><mi>C</mi></msub><mo separator="true">,</mo><msub><mi>N</mi><mtext>delay</mtext></msub><mo fence="true">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo fence="true">(</mo><mi>m</mi><mo separator="true">,</mo><msub><mtext>Auth</mtext><mi>C</mi></msub><mo separator="true">,</mo><msub><mi>N</mi><mtext>delay</mtext></msub><mo fence="true">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mtext>A</mtext><mi>i</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>N</mi><mtext>delay</mtext></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>5</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>N</mi><mtext>delay</mtext></msub></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{CM}_{{g}}={\left\lbrace\begin{matrix}{1}&amp;{\left(\text{Auth}_{{C}},{N}_{{\text{delay}}}\right)}\\{2}&amp;{\left({m},\text{Auth}_{{C}},{N}_{{\text{delay}}}\right)}\\{3}&amp;\text{A}_{{i}}\\{4}&amp;{N}_{{\text{delay}}}\\{5}&amp;{N}_{{\text{delay}}}\end{matrix}\right.}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord text"><span class="mord">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">g</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em"><span style="top:-1.366em"><span class="pstrut" style="height:3.216em"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.358em"><span class="pstrut" style="height:3.216em"></span><span style="height:1.216em;width:0.8889em"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="1.216em" style="width:0.8889em" viewBox="0 0 888.89 1216" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V1216 H384z M384 0 H504 V1216 H384z"></path></svg></span></span><span style="top:-3.216em"><span class="pstrut" style="height:3.216em"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.358em"><span class="pstrut" style="height:3.216em"></span><span style="height:1.216em;width:0.8889em"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="1.216em" style="width:0.8889em" viewBox="0 0 888.89 1216" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V1216 H384z M384 0 H504 V1216 H384z"></path></svg></span></span><span style="top:-5.566em"><span class="pstrut" style="height:3.216em"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em"><span style="top:-5.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">1</span></span></span></span><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">2</span></span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">3</span></span></span></span><span style="top:-1.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">4</span></span></span></span><span style="top:-0.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em"><span style="top:-5.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord text"><span class="mord">Auth</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal">m</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord text"><span class="mord">Auth</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">C</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span><span style="top:-0.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></div><p><strong>where</strong></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><strong><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>delay</mtext></msub></mrow><annotation encoding="application/x-tex">N_{\text{delay}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span></strong></td><td>is an unsigned 32-bit integer indicating how deep in the chain the announcing block must be before the change is applied.</td></tr><tr><td><strong>1</strong></td><td>Implies <strong>scheduled change</strong>: Schedule an authority set change after the given delay of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>delay</mtext></msub><mo>:</mo><mo>=</mo><mi mathvariant="normal">∥</mi><mtext>SubChain</mtext><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi></mrow><annotation encoding="application/x-tex">{N_{\text{delay}} := \|\text{SubChain}(B,B&#x27;)\|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.038em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">∥</span><span class="mord text"><span class="mord">SubChain</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∥</span></span></span></span></span></span> where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">{B&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span> is the block where the change is applied. The earliest digest of this type in a single block will be respected, unless a force change is present, in which case the force change takes precedence.</td></tr><tr><td><strong>2</strong></td><td>Implies <strong>forced change</strong>: Schedule a forced authority set change after the given delay of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>delay</mtext></msub><mo>:</mo><mo>=</mo><mi mathvariant="normal">∥</mi><mtext>SubChain</mtext><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mi>m</mi><mo>+</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi></mrow><annotation encoding="application/x-tex">{N_{\text{delay}} := \|\text{SubChain}(B,m + B&#x27;)\|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.038em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">∥</span><span class="mord text"><span class="mord">SubChain</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∥</span></span></span></span></span></span> where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">{B&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span> is the block where the change is applied. The earliest digest of this type in a block will be respected. <br><br> Forced changes are explained further in <a href="/sect-finality#sect-finality-forced-changes">Section 6.5.</a>.</td></tr><tr><td><strong>3</strong></td><td>Implies <strong>on disabled</strong>: An index to the individual authority in the current authority list (<a href="/chap-sync#defn-authority-list">Definition 33</a>) that should be immediately disabled until the next authority set changes. When an authority gets disabled, the node should stop performing any authority functionality from that authority, including authoring blocks and casting GRANDPA votes for finalization. Similarly, other nodes should ignore all messages from the indicated authority which pertain to their authority role.</td></tr><tr><td><strong>4</strong></td><td>Implies <strong>pause</strong>: A signal to pause the current authority set after the given delay of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>delay</mtext></msub><mo>:</mo><mo>=</mo><mi mathvariant="normal">∥</mi><mtext>SubChain</mtext><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi></mrow><annotation encoding="application/x-tex">{N_{\text{delay}} := \|\text{SubChain}(B,B&#x27;)\|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.038em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">∥</span><span class="mord text"><span class="mord">SubChain</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∥</span></span></span></span></span></span> where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">{B&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span> is a block where the change is applied. Once applied, the authorities should stop voting.</td></tr><tr><td><strong>5</strong></td><td>Implies <strong>resume</strong>: A signal to resume the current authority set after the given delay of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>delay</mtext></msub><mo>:</mo><mo>=</mo><mi mathvariant="normal">∥</mi><mtext>SubChain</mtext><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi></mrow><annotation encoding="application/x-tex">{N_{\text{delay}} := \|\text{SubChain}(B,B&#x27;)\|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.038em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">∥</span><span class="mord text"><span class="mord">SubChain</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∥</span></span></span></span></span></span> where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">{B&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span> is the block where the change is applied. Once applied, the authorities should resume voting.</td></tr></tbody></table></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="id-initiating-the-grandpa-state">6.2. Initiating the GRANDPA State<a href="#id-initiating-the-grandpa-state" class="hash-link" aria-label="Direct link to 6.2. Initiating the GRANDPA State" title="Direct link to 6.2. Initiating the GRANDPA State">​</a></h2><p>In order to participate coherently in the voting process, a validator must initiate its state and sync it with other active validators. In particular, considering that voting is happening in different distinct rounds where each round of voting is assigned a unique sequential round number <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">{r}_{{v}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, it needs to determine and set its round counter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> equal to the voting round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">{r}_{{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> currently undergoing in the network. The mandated initialization procedure for the GRANDPA protocol for a joining validator is described in detail in <a href="/sect-finality#algo-initiate-grandpa">Initiate-Grandpa</a>.</p><p>The process of joining a new voter set is different from the one of rejoining the current voter set after a network disconnect. The details of this distinction are described further in this section.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-voter-set-changes">6.2.1. Voter Set Changes<a href="#id-voter-set-changes" class="hash-link" aria-label="Direct link to 6.2.1. Voter Set Changes" title="Direct link to 6.2.1. Voter Set Changes">​</a></h3><p>A GRANDPA voter node which is initiating GRANDPA protocol as part of joining a new authority set is required to execute <a href="/sect-finality#algo-initiate-grandpa">Initiate-Grandpa</a>. The algorithm mandates the initialization procedure for GRANDPA protocol.</p><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The GRANDPA round number reset to 0 for every authority set change.</p></div></div><p>Voter set changes are signaled by Runtime via a consensus engine message (<a href="/chap-sync#sect-consensus-message-digest">Section 3.3.2.</a>). When Authorities process such messages they must not vote on any block with a higher number than the block at which the change is supposed to happen. The new authority set should reinitiate GRANDPA protocol by executing <a href="/sect-finality#algo-initiate-grandpa">Initiate-Grandpa</a>.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-initiate-grandpa">Algorithm 13. Initiate Grandpa<a href="#algo-initiate-grandpa" class="hash-link" aria-label="Direct link to Algorithm 13. Initiate Grandpa" title="Direct link to Algorithm 13. Initiate Grandpa">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_initiateGrandpa" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{Initiate-Grandpa}
\begin{algorithmic}
    \input $r_{last}, B_{last}$
    \state \textsc{Last-Finalized-Block} $\leftarrow B_{last}$
    \state \textsc{Best-Final-Candidate}$(0) \leftarrow B_{last}$
    \state \textsc{GRANDPA-GHOST}$(0) \leftarrow B_{last}$
    \state \textsc{Last-Completed-Round}$ \leftarrow 0$
    \state $r_n \leftarrow 1$
    \state \call{Play-Grandpa-round}{$r_n$}
\end{algorithmic}
\end{algorithm}</pre></div><p>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mtext>last</mtext></msub></mrow><annotation encoding="application/x-tex">{B}_{{\text{last}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">last</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is the last block which has been finalized on the chain (<a href="/sect-finality#defn-finalized-block">Definition 94</a>). <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mtext>last</mtext></msub></mrow><annotation encoding="application/x-tex">{r}_{{\text{last}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">last</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is equal to the latest round the voter has observed that other voters are voting on. The voter obtains this information through various gossiped messages including those mentioned in <a href="/sect-finality#defn-finalized-block">Definition 94</a>. <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mtext>last</mtext></msub></mrow><annotation encoding="application/x-tex">{r}_{{\text{last}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">last</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is set to <em>0</em> if the GRANDPA node is initiating the GRANDPA voting process as a part of a new authority set. This is because the GRANDPA round number resets to <em>0</em> for every authority set change.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="id-rejoining-the-same-voter-set">6.3. Rejoining the Same Voter Set<a href="#id-rejoining-the-same-voter-set" class="hash-link" aria-label="Direct link to 6.3. Rejoining the Same Voter Set" title="Direct link to 6.3. Rejoining the Same Voter Set">​</a></h2><p>When a voter node rejoins the network after a disconnect from the voter set and with the condition that there has been no change to the voter set at the time of the disconnect, the node must continue performing the GRANDPA protocol at the same state as before getting disconnected from the network, ignoring any possible progress in GRANDPA finalization. Following reconnection, the node eventually gets updated to the current GRANDPA round and synchronizes its state with the rest of the voting set through the process called Catchup (<a href="/sect-finality#sect-grandpa-catchup">Section 6.6.1.</a>).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="id-voting-process-in-round-r">6.4. Voting Process in Round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span><a href="#id-voting-process-in-round-r" class="hash-link" aria-label="Direct link to id-voting-process-in-round-r" title="Direct link to id-voting-process-in-round-r">​</a></h2><p>For each round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span>, an honest voter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> must participate in the voting process by following <a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a>.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-grandpa-round">Algorithm 14. Play Grandpa Round<a href="#algo-grandpa-round" class="hash-link" aria-label="Direct link to Algorithm 14. Play Grandpa Round" title="Direct link to Algorithm 14. Play Grandpa Round">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_playGrandpaRound" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{Play-Grandpa-Round}
\begin{algorithmic}
    \REQUIRE($r$)
    \STATE $t_{r, v} \leftarrow$ Current local time
    \STATE $\textrm{primary} \leftarrow$ \call{Derive-Primary}{$r$}
    \IF{$v = \textrm{primary}$}
      \STATE \call{Broadcast}{$M_{v}^{r - 1, \textrm{Fin}}($\call{Best-Final-Candidate}{$r - 1$}$)$}
      \IF{\call{Best-Final-Candidate}{$r - 1$} $\geqslant$ \textsc{Last-Finalized-Block}}
        \STATE \call{Broadcast}{$M_{v}^{r - 1, \textrm{Prim}}($\call{Best-Final-Candidate}{$r - 1$}$)$}
      \ENDIF
    \ENDIF
    \STATE \call{Receive-Messages}{\textbf{until} Time $\geqslant t_{r_,v} + 2 \times T$ \or $r$ \textbf{is} completable}
    \STATE $L \leftarrow$ \call{Best-Final-Candidate}{$r - 1$}
    \STATE $N \leftarrow$ \call{Best-PreVote-Candidate}{$r$}
    \STATE \call{Broadcast}{$M_v^{r, \textrm{pv}} (N)$}
    \STATE \call{Receive-Messages}{\textbf{until} $B^{r,\textrm{pv}}_v \geqslant L$ \and $($ Time $\geqslant t_{r_,v} + 4 \times T$ \or $r$ \textbf{is} completable $)$}
    \STATE \call{Broadcast}{$M_v^{r, \textrm{pc}}(B_v^{r, \textrm{pv}})$}
    
    \REPEAT
      \STATE \call{Receive-Messages}{}
      \STATE \call{Attempt-To-Finalize-At-Round}{$r$}
    \UNTIL{$r$ \textbf{is} completable \and \call{Finalizable}{$r$} \and \textsc{Last-Finalized-Block} $\geqslant$ \call{Best-Final-Candidate}{$r - 1$}}
    
    \STATE \call{Play-Grandpa-round}{$r + 1$}
    
    \REPEAT
      \STATE \call{Receive-Messages}{}
      \STATE \call{Attempt-To-Finalize-At-Round}{$r$}
    \UNTIL{\textsc{Last-Finalized-Block} $\geqslant$ \call{Best-Final-Candidate}{$r$}}
    
    \IF{$r > $ \textsc{Last-Completed-Round}}
      \STATE \textsc{Last-Completed-Round} $\leftarrow r$
    \ENDIF
\end{algorithmic}
\end{algorithm}</pre></div><p><strong>where</strong>  </p><ul><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span></span></span> is sampled from a log-normal distribution whose mean and standard deviation are equal to the average network delay for a message to be sent and received from one validator to another.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Derive-Primary</mtext></mrow><annotation encoding="application/x-tex">\text{Derive-Primary}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">Derive-Primary</span></span></span></span></span></span> is described in <a href="/sect-finality#algo-derive-primary">Derive-Primary</a>.</p></li><li><p>The condition of <em>completablitiy</em> is defined in <a href="/sect-finality#defn-grandpa-completable">Definition 90</a>.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Best-Final-Candidate</mtext></mrow><annotation encoding="application/x-tex">\text{Best-Final-Candidate}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">Best-Final-Candidate</span></span></span></span></span></span> function is explained in <a href="/sect-finality#algo-grandpa-best-candidate">Best-Final-Candidate</a>.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Attempt-To-Finalize-At-Round</mtext><mrow><mo fence="true">(</mo><mi>r</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Attempt-To-Finalize-At-Round}{\left({r}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Attempt-To-Finalize-At-Round</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> is described in <a href="/sect-finality#algo-attempt-to%E2%80%93finalize">Attempt-To-Finalize-At-Round</a>.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Finalizable</mtext></mrow><annotation encoding="application/x-tex">\text{Finalizable}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">Finalizable</span></span></span></span></span></span> is defined in <a href="/sect-finality#algo-finalizable">Finalizable</a>.</p></li></ul></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-derive-primary">Algorithm 15. Derive Primary<a href="#algo-derive-primary" class="hash-link" aria-label="Direct link to Algorithm 15. Derive Primary" title="Direct link to Algorithm 15. Derive Primary">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_derivePrimary" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{Derive-Primary}
\begin{algorithmic}
    \input $r$
    \return $r \bmod |\mathbb{V}|$
\end{algorithmic}
\end{algorithm}</pre></div><p>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> is the GRANDPA round whose primary is to be determined.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-grandpa-best-candidate">Algorithm 16. Best Final Candidate<a href="#algo-grandpa-best-candidate" class="hash-link" aria-label="Direct link to Algorithm 16. Best Final Candidate" title="Direct link to Algorithm 16. Best Final Candidate">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_bestFinalCandidate" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{Best-Final-Candidate}
\begin{algorithmic}
    \input $r$
    \state $B_v^{r, pv} \leftarrow$ \call{GRANDPA-GHOST}{$r$}
    \if{$r = 0$}
        \return $B_v^{r, pv}$
    \else
        \state $\mathcal{C} \leftarrow \{ B' | B' \leqslant B_v^{r,pv} | \#V^{r, pc}_{\operatorname{obv}(v), pot}(B') > \frac{2}{3} |\mathbb{V}| \}$
        \if{$\mathcal{C} = \phi$}
            \return $B_v^{r, pv}$
        \else
            \return $E \in \mathcal{C} : H_n (E) = \operatorname{max}\left(H_n (B') | B' \in \mathcal{C}\right)$
        \endif
    \endif
\end{algorithmic}
\end{algorithm}</pre></div><p>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">#</mi><msubsup><mi>V</mi><mrow><mtext>obv</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mi>p</mi><mi>o</mi><mi>t</mi></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mi>p</mi><mi>c</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\#{{V}_{{\text{obv}{\left({v}\right)},{p}{o}{t}}}^{{{r},{p}{c}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2975em;vertical-align:-0.5152em"></span><span class="mord">#</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obv</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span><span class="mord mtight"><span class="mord mathnormal mtight">o</span></span><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span></span></span></span></span> is defined in <a href="/sect-finality#defn-total-potential-votes">Definition 88</a>.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-grandpa-ghost">Algorithm 17. GRANDPA GHOST<a href="#algo-grandpa-ghost" class="hash-link" aria-label="Direct link to Algorithm 17. GRANDPA GHOST" title="Direct link to Algorithm 17. GRANDPA GHOST">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_grandpaGhost" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{GRANDPA-GHOST}
\begin{algorithmic}
    \input $r$
    \if{$r = 0$}
        \state $G \leftarrow B_{last}$
    \else
        \state $L \leftarrow$ \call{Best-Final-Candidate}{$r - 1$}
        \state $\mathcal{G} = \{ \forall B > L | \#V_{\operatorname{obs}(v)}^{r, pv}(B) \geqslant \frac{2}{3} |\mathbb{V}| \}$
        \if{$\mathcal{G} = \phi$}
            \state $G \leftarrow L$
        \else
            \state $G \in \mathcal{G} | H_n(G) = \operatorname{max}\left( H_n (B) | \forall B \in \mathcal{G} \right)$
        \endif
    \endif
    \return $G$
\end{algorithmic}
\end{algorithm}</pre></div><p><strong>where</strong>  </p><ul><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mtext>last</mtext></msub></mrow><annotation encoding="application/x-tex">{B}_{{\text{last}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">last</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is the last block which has been finalized on the chain (<a href="/sect-finality#defn-finalized-block">Definition 94</a>).</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">#</mi><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mi>p</mi><mi>v</mi></mrow></msubsup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\#{{V}_{{\text{obs}{\left({v}\right)}}}^{{{r},{p}{v}}}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2975em;vertical-align:-0.5152em"></span><span class="mord">#</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> is defined in <a href="/sect-finality#defn-observed-votes">Definition 87</a>.</p></li></ul></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-best-prevote-candidate">Algorithm 18. Best PreVote Candidate<a href="#algo-best-prevote-candidate" class="hash-link" aria-label="Direct link to Algorithm 18. Best PreVote Candidate" title="Direct link to Algorithm 18. Best PreVote Candidate">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_bestPrevoteCandidate" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{Best-PreVote-Candidate}
\begin{algorithmic}
    \input $r$
    \state $B^{r, pv}_v \leftarrow$ \call{GRANDPA-GHOST}{$r$}
    \if{\call{Received}{$M_{v_{primary}}^{r, prim}(B))$ \and $B^{r, pv}_v \geqslant B > L$}}
        \state $N \leftarrow B$
    \else
        \state $N \leftarrow B^{r, pv}_v$
    \endif
\end{algorithmic}
\end{algorithm}</pre></div></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-attempt-to–finalize">Algorithm 19. Attempt To Finalize At Round<a href="#algo-attempt-to–finalize" class="hash-link" aria-label="Direct link to Algorithm 19. Attempt To Finalize At Round" title="Direct link to Algorithm 19. Attempt To Finalize At Round">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_attemptToFinalizeAtRound" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{Attempt-To-Finalize-At-Round}
\begin{algorithmic}
    \REQUIRE($r$)
    \STATE $L \leftarrow$ \textsc{Last-Finalized-Block}
    \STATE $E \leftarrow$ \call{Best-Final-Candidate}{$r$}
    \IF{$E \geqslant L$ \and ${V^{r, \textrm{pc}}_{\textrm{obs}(v)}}(E) > 2 / 3 |\mathbb{V}|$}
    \STATE{\textsc{Last-Finalized-Block}$\leftarrow E$}
    \IF{$M_v^{r, \textrm{Fin}} (E) \notin $\textsc{Received-Messages}}
        \STATE \call{Broadcast}{$M_v^{r, \textrm{Fin}}(E)$}
        \RETURN
    \ENDIF
    \ENDIF
\end{algorithmic}
\end{algorithm}</pre></div></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-finalizable">Algorithm 20. Finalizable<a href="#algo-finalizable" class="hash-link" aria-label="Direct link to Algorithm 20. Finalizable" title="Direct link to Algorithm 20. Finalizable">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_finalizable" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{Finalizable}
\begin{algorithmic}
    \REQUIRE($r$)
    \IF{$r$ \textbf{is not} Completable}
        \RETURN \textbf{False}
    \ENDIF
    \STATE $G \leftarrow$ \call{GRANDPA-GHOST}{$J^{r, pv}(B)$}
    \IF{$G = \phi$}
        \RETURN \textbf{False}
    \ENDIF
    \STATE $E_r \leftarrow$ \call{Best-Final-Candidate}{$r$}
    \IF{$E_r \neq \phi$ \and \call{Best-Final-Candidate}{$r - 1$} $\leqslant E_r \leqslant G$}
        \RETURN \textbf{True}
    \ELSE
        \RETURN \textbf{False}
    \ENDIF
\end{algorithmic}
\end{algorithm}</pre></div><p>where the condition for <em>completability</em> is defined in <a href="/sect-finality#defn-grandpa-completable">Definition 90</a>.</p></div></div><p>Note that we might not always succeed in finalizing our best candidate due to the possibility of equivocation. We might even not finalize anything in a round (although <a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a> prevents us from moving to the round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{r}+{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord"><span class="mord">1</span></span></span></span></span></span> before finalizing the best final candidate of round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{r}-{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord"><span class="mord">1</span></span></span></span></span></span>) The example in <a href="/sect-finality#defn-unfinalized-candidate">Definition 92</a> serves to demonstrate a situation where the best final candidate of a round cannot be finalized during its own round:</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-unfinalized-candidate">Definition 92. Unfinalized Candidate<a href="#defn-unfinalized-candidate" class="hash-link" aria-label="Direct link to Definition 92. Unfinalized Candidate" title="Direct link to Definition 92. Unfinalized Candidate">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>Let us assume that we have 100 voters and there are two blocks in the chain (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{1}}&lt;{B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>). At round 1, we get 67 pre-votes for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> and at least one pre-vote for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> which means that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>GRANDPA-GHOST</mtext><mrow><mo fence="true">(</mo><mn>1</mn><mo fence="true">)</mo></mrow><mo>=</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\text{GRANDPA-GHOST}{\left({1}\right)}={B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">GRANDPA-GHOST</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord">1</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p><p>Subsequently, potentially honest voters who could claim not seeing all the pre-votes for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> but receiving the pre-votes for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> would pre-commit to <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>. In this way, we receive 66 pre-commits for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> and 1 pre-commit for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>. Henceforth, we finalize <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> since we have a threshold commit (67 votes) for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p><p>At this point, though, we have <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Best-Final-Candidate</mtext><mrow><mo fence="true">(</mo><mi>r</mi><mo fence="true">)</mo></mrow><mo>=</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathtt{\text{Best-Final-Candidate}}}{\left({r}\right)}={B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord text"><span class="mord">Best-Final-Candidate</span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> as <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">#</mi><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>v</mi><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mtext>pot</mtext></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>stage</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><msub><mi>B</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow><mo>=</mo><mn>67</mn></mrow><annotation encoding="application/x-tex">\#{{V}_{{\text{obs}{\left({v}\right)},\text{pot}}}^{{{r},\text{stage}}}}{\left({B}_{{2}}\right)}={67}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4267em;vertical-align:-0.5152em"></span><span class="mord">#</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9115em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pot</span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">stage</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord"><span class="mord">67</span></span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{2}&gt;{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord">2</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord"><span class="mord">1</span></span></span></span></span></span>.</p><p>However, at this point, the round is already completable as we know that we have <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>GRANDPA-GHOST</mtext><mrow><mo fence="true">(</mo><mn>1</mn><mo fence="true">)</mo></mrow><mo>=</mo><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathtt{\text{GRANDPA-GHOST}}}{\left({1}\right)}={B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord text"><span class="mord">GRANDPA-GHOST</span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord">1</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> as an upper limit on what we can finalize and nothing greater than <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> can be finalized at <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{r}={1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord"><span class="mord">1</span></span></span></span></span></span>. Therefore, the condition of <a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a> is satisfied and we must proceed to round 2.</p><p>Nonetheless, we must continue to attempt to finalize round <em>1</em> in the background as the condition of <a href="/sect-finality#algo-attempt-to%E2%80%93finalize">Attempt-To-Finalize-At-Round</a> has not been fulfilled.</p><p>This prevents us from proceeding to round 3 until either:</p><ul><li><p>We finalize <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> in round 2, or</p></li><li><p>We receive an extra pre-commit vote for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> in round 1. This will make it impossible to finalize <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{B}_{{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> in round 1, no matter to whom the remaining pre-commits are going to be cast for (even with considering the possibility of 1/3 of voter equivocating) and therefore we have <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Best-Final-Candidate</mtext><mrow><mo fence="true">(</mo><mi>r</mi><mo fence="true">)</mo></mrow><mo>=</mo><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{\mathtt{\text{Best-Final-Candidate}}}{\left({r}\right)}={B}_{{1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord text"><span class="mord">Best-Final-Candidate</span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>.</p></li></ul><p>Both scenarios unblock <a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Last-Finalized-Block</mtext><mo>≥</mo><mtext>Best-Final-Candidate</mtext><mrow><mo fence="true">(</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\mathtt{\text{Last-Finalized-Block}}}\ge{\mathtt{\text{Best-Final-Candidate}}}{\left({r}-{1}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.136em"></span><span class="mord"><span class="mord text"><span class="mord">Last-Finalized-Block</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord text"><span class="mord">Best-Final-Candidate</span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord">1</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> albeit in different ways: the former with increasing the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Last-Finalized-Block</mtext></mrow><annotation encoding="application/x-tex">{\mathtt{\text{Last-Finalized-Block}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord"><span class="mord text"><span class="mord">Last-Finalized-Block</span></span></span></span></span></span></span> and the latter with decreasing <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Best-Final-Candidate</mtext><mrow><mo fence="true">(</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\mathtt{\text{Best-Final-Candidate}}}{\left({r}-{1}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord text"><span class="mord">Best-Final-Candidate</span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord">1</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sect-finality-forced-changes">6.5. Forced Authority Set Changes<a href="#sect-finality-forced-changes" class="hash-link" aria-label="Direct link to 6.5. Forced Authority Set Changes" title="Direct link to 6.5. Forced Authority Set Changes">​</a></h2><p>In a case of emergency where the Polkadot network is unable to finalize blocks, such as in the event of a mass validator outage, the Polkadot governance mechanism must enact a forced change, which the Host must handle in a specific manner. Given that in such a case, finality cannot be relied on, the Host must detect the forced change (<a href="/sect-finality#defn-consensus-message-grandpa">Definition 91</a>) in a (valid) block and apply it to all forks.</p><p>The <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>∈</mo><mi>C</mi><msub><mi>M</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">{m}\in{C}{M}_{{g}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em"></span><span class="mord"><span class="mord mathnormal">m</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">g</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span>, which is specified by the governance mechanism, defines the starting block at which <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mtext>delay</mtext></msub></mrow><annotation encoding="application/x-tex">{N}_{{\text{delay}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">delay</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> is applied. This provides some degree of probabilistic consensus to the network with the assumption that the forced change was received by most participants and that finality can be continued.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="img-scheduled-change">Image 6. Applying a scheduled change<a href="#img-scheduled-change" class="hash-link" aria-label="Direct link to Image 6. Applying a scheduled change" title="Direct link to Image 6. Applying a scheduled change">​</a></h6><p><img loading="lazy" src="/assets/images/scheduled-change-6f4cf547417d699e492e9b563ccd5867.png" width="1746" height="766" class="img_ev3q"></p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="img-forced-change">Image 7. Applying a forced change<a href="#img-forced-change" class="hash-link" aria-label="Direct link to Image 7. Applying a forced change" title="Direct link to Image 7. Applying a forced change">​</a></h6><p><img loading="lazy" src="/assets/images/forced-change-2944560a62e2b9898252b1c1fa7b727f.png" width="1746" height="766" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sect-block-finalization">6.6. Block Finalization<a href="#sect-block-finalization" class="hash-link" aria-label="Direct link to 6.6. Block Finalization" title="Direct link to 6.6. Block Finalization">​</a></h2><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-justified-block-header">Definition 93. Justified Block Header<a href="#defn-justified-block-header" class="hash-link" aria-label="Direct link to Definition 93. Justified Block Header" title="Direct link to Definition 93. Justified Block Header">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>The Justified Block Header is provided by the consensus engine and presented to the Polkadot Host for the block to be appended to the blockchain. It contains the following parts:</p><ul><li><p><strong>block_header</strong> the complete block header (<a href="/chap-state#defn-block-header">Definition 10</a>) and denoted by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Head</mtext><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Head}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Head</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span>.</p></li><li><p><strong>justification</strong>: as defined by the consensus specification indicated by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Just</mtext><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Just}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Just</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> as defined in <a href="/sect-finality#defn-grandpa-justification">Definition 83</a>.</p></li><li><p><strong>authority Ids</strong>: This is the list of the IDs of authorities which have voted for the block to be stored and is formally referred to as <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{A}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">A</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span>. An authority ID is 256-bit.</p></li></ul></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-finalized-block">Definition 94. Finalized<a href="#defn-finalized-block" class="hash-link" aria-label="Direct link to Definition 94. Finalized" title="Direct link to Definition 94. Finalized">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>A Polkadot relay chain node <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span></span></span> should consider block <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span> as <strong>finalized</strong> if any of the following criteria hold for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≥</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">{B}&#x27;\ge{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879em;vertical-align:-0.136em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span></span></span></span></span>:</p><ul><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>V</mi><mrow><mtext>obs</mtext><mrow><mo fence="true">(</mo><mi>n</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>r</mi><mo separator="true">,</mo><mtext>pc</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo>&gt;</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mrow><mo fence="true">∣</mo><msub><mi mathvariant="double-struck">V</mi><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msub><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">{{V}_{{\text{obs}{\left({n}\right)}}}^{{{r},\text{pc}}}}{\left({B}&#x27;\right)}&gt;\frac{{2}}{{3}}{\left|{\mathbb{{V}}}_{{{B}&#x27;}}\right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2975em;vertical-align:-0.5152em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7823em"><span style="top:-2.3598em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">obs</span></span><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em"><span class="mtight">(</span></span><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span><span class="mclose mtight delimcenter" style="top:0em"><span class="mtight">)</span></span></span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">pc</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">∣</span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbb">V</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">∣</span></span></span></span></span></span></span>.</p></li><li><p>It receives a <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>M</mi><mi>v</mi><mrow><mi>r</mi><mo separator="true">,</mo><mtext>Fin</mtext></mrow></msubsup><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{M}_{{v}}^{{{r},\text{Fin}}}}{\left({B}&#x27;\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span><span class="mpunct mtight">,</span><span class="mord text mtight"><span class="mord mtight">Fin</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> message in which <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>J</mi><mi>r</mi></msup><mrow><mo fence="true">(</mo><mi>B</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{J}^{{r}}{\left({B}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> justifies the finalization (<a href="/sect-finality#defn-grandpa-justification">Definition 83</a>).</p></li><li><p>It receives a block data message for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">{B}&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> with <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Just</mtext><mrow><mo fence="true">(</mo><msup><mi>B</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Just}{\left({B}&#x27;\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Just</span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> (<a href="/sect-finality#defn-justified-block-header">Definition 93</a>) which justifies the finalization.</p></li></ul><p>for:</p><ul><li><p>Any round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> if the node <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span></span></span> is <em>not</em> a GRANDPA voter.</p></li><li><p>Only for round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> for which the node <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span></span></span> has invoked <a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a> and round <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{r}+{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord"><span class="mord">1</span></span></span></span></span></span> if <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span></span></span> is a GRANDPA voter and has already caught up to its peers according to the process described in Section <a href="/sect-finality#sect-grandpa-catchup">Section 6.6.1.</a>.</p></li></ul><p>Note that all Polkadot relay chain nodes are supposed to process GRANDPA commit messages regardless of their GRANDPA voter status.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sect-grandpa-catchup">6.6.1. Catching up<a href="#sect-grandpa-catchup" class="hash-link" aria-label="Direct link to 6.6.1. Catching up" title="Direct link to 6.6.1. Catching up">​</a></h3><p>When a Polkadot node (re)joins the network, it requests the history of state transitions in the form of blocks, which it is missing.</p><p>Nonetheless, the process is different for a GRANDPA voter node. When a voter node joins the network, it needs to gather the justification (<a href="/sect-finality#defn-grandpa-justification">Definition 83</a>) of the rounds it has missed. Through this process, they can safely join the voting process of the current round, on which the voting is taking place.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sect-sending-catchup-request">6.6.1.1. Sending the catch-up requests<a href="#sect-sending-catchup-request" class="hash-link" aria-label="Direct link to 6.6.1.1. Sending the catch-up requests" title="Direct link to 6.6.1.1. Sending the catch-up requests">​</a></h4><p>When a Polkadot voter node has the same authority list as a peer voter node who is reporting a higher number for the <em>finalized round</em> field, it should send a catch-up request message (<a href="/chap-networking#defn-grandpa-catchup-request-msg">Definition 53</a>) to the reporting peer. This will allow the node to to catch up to the more advanced finalized round, provided that the following criteria hold:</p><ul><li><p>The peer node is a GRANDPA voter, and:</p></li><li><p>The last known finalized round for the Polkadot node is at least two rounds behind the finalized round for the peer.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="id-processing-the-catch-up-requests">6.6.1.2. Processing the catch-up requests<a href="#id-processing-the-catch-up-requests" class="hash-link" aria-label="Direct link to 6.6.1.2. Processing the catch-up requests" title="Direct link to 6.6.1.2. Processing the catch-up requests">​</a></h4><p>Only GRANDPA voter nodes are required to respond to the catch-up requests. Additionally, it is only GRANDPA voters who are supposed to send catch-up requests. As such GRANDPA voters could safely ignore the catch-up requests from non-voter nodes. When a GRANDPA voter node receives a catch-up request message, it needs to execute <a href="/sect-finality#algo-process-catchup-request">Process-Catchup-Request</a>. Note: a voter node should not respond to catch-up requests for rounds that are actively being voted on. Those are the rounds for which <a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a> is not concluded.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-process-catchup-request">Algorithm 21. Process Catchup Request<a href="#algo-process-catchup-request" class="hash-link" aria-label="Direct link to Algorithm 21. Process Catchup Request" title="Direct link to Algorithm 21. Process Catchup Request">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_processCatchupRequest" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{Process-Catchup-Request}
\begin{algorithmic}
    \input $M_{i, v}^\text{Cat-q}(\text{id}_\mathbb{V}, r)$
    \if{$M_{i, v}^\text{Cat-q}(\text{id}_\mathbb{V}, r).\text{id}_\mathbb{V} \neq \text{id}_\mathbb{V}$}
        \state \textbf{error} ``Catching up on different set''
    \endif
    \if{$i \notin \mathbb{P}$}
        \state \textbf{error} ``Requesting catching up from a non-peer''
    \endif
    \if{$r >$ \textsc{Last-Completed-Round}}
        \state \textbf{error} ``Catching up on a round in the future''
    \endif
    \state \call{Send}{$i, M_{v, i}^\text{Cat-s}(\text{id}_\mathbb{V}, r)$}
\end{algorithmic}
\end{algorithm}</pre></div><p><strong>where</strong>  </p><ul><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>M</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>v</mi></mrow><mrow><mtext>Cat</mtext><mo>−</mo><mi>q</mi></mrow></msubsup><mrow><mo fence="true">(</mo><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub><mo separator="true">,</mo><mi>r</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{M}_{{{i},{v}}}^{{\text{Cat}-{q}}}}{\left(\text{id}_{{{\mathbb{{V}}}}},{r}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3722em;vertical-align:-0.413em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9592em"><span style="top:-2.4231em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span></span><span style="top:-3.1809em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Cat</span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">q</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> is the catch-up message received from peer <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord"><span class="mord mathnormal">i</span></span></span></span></span></span> (<a href="/chap-networking#defn-grandpa-catchup-request-msg">Definition 53</a>).</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub></mrow><annotation encoding="application/x-tex">\text{id}_{{{\mathbb{{V}}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> (<a href="/sect-finality#defn-authority-set-id">Definition 78</a>) is the voter set id with which the serving node is operating</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span></span></span></span></span> is the round number for which the catch-up is requested for.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">P</mi></mrow><annotation encoding="application/x-tex">{\mathbb{{P}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord"><span class="mord"><span class="mord mathbb">P</span></span></span></span></span></span></span> is the set of immediate peers of node <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span>.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Last-Completed-Round</mtext></mrow><annotation encoding="application/x-tex">{\mathtt{\text{Last-Completed-Round}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord text"><span class="mord">Last-Completed-Round</span></span></span></span></span></span></span> is initiated in <a href="/sect-finality#algo-initiate-grandpa">Initiate-Grandpa</a> and gets updated by <a href="/sect-finality#algo-grandpa-round">Play-Grandpa-Round</a>.</p></li><li><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>M</mi><mrow><mi>v</mi><mo separator="true">,</mo><mi>i</mi></mrow><mrow><mtext>Cat</mtext><mo>−</mo><mi>s</mi></mrow></msubsup><mrow><mo fence="true">(</mo><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub><mo separator="true">,</mo><mi>r</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{M}_{{{v},{i}}}^{{\text{Cat}-{s}}}}{\left(\text{id}_{{{\mathbb{{V}}}}},{r}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2944em;vertical-align:-0.413em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8815em"><span style="top:-2.4231em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span style="top:-3.1031em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Cat</span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> is the catch-up response (<a href="/chap-networking#defn-grandpa-catchup-response-msg">Definition 54</a>).</p></li></ul></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="id-processing-catch-up-responses">6.6.1.3. Processing catch-up responses<a href="#id-processing-catch-up-responses" class="hash-link" aria-label="Direct link to 6.6.1.3. Processing catch-up responses" title="Direct link to 6.6.1.3. Processing catch-up responses">​</a></h4><p>A Catch-up response message contains critical information for the requester node to update their view on the active rounds that are being voted on by GRANDPA voters. As such, the requester node should verify the content of the catch-up response message and subsequently updates its view of the state of the finality of the Relay chain according to <a href="/sect-finality#algo-process-catchup-response">Process-Catchup-Response</a>.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="algo-process-catchup-response">Algorithm 22. Process Catchup Response<a href="#algo-process-catchup-response" class="hash-link" aria-label="Direct link to Algorithm 22. Process Catchup Response" title="Direct link to Algorithm 22. Process Catchup Response">​</a></h6><div class="alert alert--algorithm"><h5></h5><div><div><pre id="_ps_processCatchupResponse" class="pseudocode" style="display: hidden">\begin{algorithm}
\caption{Process-Catchup-Response}
\begin{algorithmic}
    \input $M_{v,i}^\text{Cat-s}(\text{id}_{\mathbb{V}}, r)$
    \state $M_{v,i}^\text{Cat-s}(\text{id}_{\mathbb{V}}, r).\text{id}_{\mathbb{V}}, r, J^{r, pv}(B), J^{r, pc}(B), H_h(B'), H_i(B') \leftarrow \text{Dec}_{SC}(M_{v, i}^{Cat-s}(\text{id}_{\mathbb{V}}, r)$
    \if{$M_{v, i}^\text{Cat-s}(\text{id}_{\mathbb{V}}, r).\text{id}_{\mathbb{V}} \neq \text{id}_{\mathbb{V}}$}
        \state \textbf{error} ``Catching up on different set''
    \endif
    \if{$r \leqslant$ \textsc{Leading-Round}}
        \state \textbf{error} ``Catching up in to the past''
    \endif
    \if{$J^{r, pv}(B)$ \textbf{is not} valid}
        \state \textbf{error} ``Invalid pre-vote justification''
    \endif
    \if{$J^{r, pc}(B)$ \textbf{is not} valid}
        \state \textbf{error} ``Invalid pre-commit justification''
    \endif
    \state $G \leftarrow$ \call{GRANDPA-GHOST}{$J^{r, pv}(B)$}
    \if{$G = \phi$}
        \state \textbf{error} ``GHOST-less Catch-up''
    \endif
    \if{$r$ \textbf{is not} completable}
        \state \textbf{error} ``Catch-up round is not completable''
    \endif
    \if{$J^{r, pc}(B)$ justifies $B'$ finalization}
        \state \textbf{error} ``Unjustified Catch-up target finalization''
    \endif
    \state \textsc{Last-Completed-Round} $\leftarrow r$
    \if{$i \in \mathbb{V}$}
        \state \call{Play-Grandpa-round}{$r + 1$}
    \endif
\end{algorithmic}
\end{algorithm}</pre></div><p>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>M</mi><mrow><mi>v</mi><mo separator="true">,</mo><mi>i</mi></mrow><mrow><mtext>Cat</mtext><mo>−</mo><mi>s</mi></mrow></msubsup><mrow><mo fence="true">(</mo><msub><mtext>id</mtext><mi mathvariant="double-struck">V</mi></msub><mo separator="true">,</mo><mi>r</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">{{M}_{{{v},{i}}}^{{\text{Cat}-{s}}}}{\left(\text{id}_{{{\mathbb{{V}}}}},{r}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2944em;vertical-align:-0.413em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8815em"><span style="top:-2.4231em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span style="top:-3.1031em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Cat</span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord text"><span class="mord">id</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">V</span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">r</span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span></span></span> is the catch-up response received from node <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span></span> (<a href="/chap-networking#defn-grandpa-catchup-response-msg">Definition 54</a>).</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sect-grandpa-beefy">6.7. Bridge design (BEEFY)<a href="#sect-grandpa-beefy" class="hash-link" aria-label="Direct link to 6.7. Bridge design (BEEFY)" title="Direct link to 6.7. Bridge design (BEEFY)">​</a></h2><p>The BEEFY (Bridge Efficiency Enabling Finality Yielder) is a secondary protocol to GRANDPA to support efficient bridging between the Polkadot network (relay chain) and remote, segregated blockchains, such as Ethereum, which were not built with the Polkadot interchain operability in mind. BEEFY’s aim is to enable clients to efficiently follow a chain that has GRANDPA finality, a finality gadget created for Substrate/Polkadot ecosystem. This is useful for bridges (e.g., Polkadot-&gt;Ethereum), where a chain can follow another chain and light clients suitable for low storage devices such as mobile phones.</p><p>The protocol allows participants of the remote network to verify finality proofs created by the Polkadot relay chain validators. In other words: clients in the target network (e.g., Ethereum) can verify that the Polkadot network is at a specific state.</p><p>Storing all the information necessary to verify the state of the remote chain, such as the block headers, is too expensive. BEEFY stores the information in a space-efficient way, and clients can request additional information over the protocol.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-motivation-beefy-1">6.7.1. Motivation<a href="#id-motivation-beefy-1" class="hash-link" aria-label="Direct link to 6.7.1. Motivation" title="Direct link to 6.7.1. Motivation">​</a></h3><p>A client could just follow GRANDPA using GRANDPA justifications, sets of signatures from validators. This is used for some substrate-substrate bridges and in light clients such as the Substrate Connect browser extension. GRANDPA was designed for fast and secure finality. Certain design decisions, like validators voting for different blocks in a justification and using ED25519 signatures, allow fast finality. However, GRANDPA justifications are large and are expensive to verify on other chains like Ethereum that do not support some cryptographic signature schemes. Thus, BEEFY adds an extra layer of finality that allows lighter bridges and clients for Polkadot.</p><p>To summarise, the goals of BEEFY are:</p><ul><li>Allow customization of signature schemes to adapt to different target chains. </li><li>Minimize the size of the finality proof and the effort required by a light client to follow finality. </li><li>Unify data types and use backward-compatible versioning so that the protocol can be extended (additional payload, different signature schemes) without breaking existing light clients.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-overview-beefy-1">6.7.2. Protocol Overview<a href="#id-overview-beefy-1" class="hash-link" aria-label="Direct link to 6.7.2. Protocol Overview" title="Direct link to 6.7.2. Protocol Overview">​</a></h3><p>Since BEEFY runs on top of GRANDPA, similarly to how GRANDPA is lagging behind the best produced (non-finalized) block, BEEFY finalized block lags behind the best GRANDPA (finalized) block. </p><ul><li>The BEEFY validator set is the same as GRANDPA&#x27;s. However, they might be using different types of session keys to sign BEEFY messages. </li><li>From a single validator perspective, BEEFY has at most one active voting round. </li><li>Since GRANDPA validators are reaching finality, we assume they are online and well-connected and have a similar view of the state of the blockchain.</li></ul><p>BEEFY consists of two components:</p><p>a. <strong>Consensus Extension</strong> on GRANDPA finalization that is a voting round. </p><p>The consensus extension serves to have a smaller consensus justification than GRANDPA and alternative cryptography, which helps the light client side of the BEEFY protocol described below. </p><p>b. An efficient <strong>protocol</strong> for convincing on-chain/ off-chain light clients about the finality vote.</p><p>In the BEEFY light-client protocol, a full node or bridge relayer (prover) wants to convince a light client (verifier, e.g., a smart contract implemented on the target chain)  of the outcome of BEEFY votes. The prover has access to all voting data from the BEEFY voting round. The prover may generate a single-shot proof (for e.g. using SNARKS)  and send it to the verifier or they may engage in an interactive protocol with several rounds of communication.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-preliminaries-2">6.7.3. Preliminaries<a href="#id-preliminaries-2" class="hash-link" aria-label="Direct link to 6.7.3. Preliminaries" title="Direct link to 6.7.3. Preliminaries">​</a></h3><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-beefy-key">Definition 95. BEEFY Session Keys<a href="#defn-beefy-key" class="hash-link" aria-label="Direct link to Definition 95. BEEFY Session Keys" title="Direct link to Definition 95. BEEFY Session Keys">​</a></h6><p>Validators use an <code>ECDSA</code> key scheme for signing Beefy messages. This is different from schemes like <code>sr25519</code> and <code>ed25519</code>, which are commonly used in Substrate for other components like BABE, and GRANDPA. The most noticeable difference is that an <code>ecdsa</code>
public key is <code>33</code> bytes long, instead of <code>32</code> bytes for a <code>sr25519</code> based public key. As a consequence, the <code>AccountId</code> (32-bytes) matches the <code>PublicKey</code> for other session keys, but note that it&#x27;s not the case for BEEFY.</p><div class="alert alert--definition"><h5></h5><div><p><strong>BEEFY session key pair</strong> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><mi>s</mi><msubsup><mi>k</mi><mi>j</mi><mi>B</mi></msubsup><mo separator="true">,</mo><mi>p</mi><msubsup><mi>k</mi><mi>j</mi><mi>B</mi></msubsup><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">{\left({s}{{k}_{{j}}^{B}},{p}{{k}_{{j}}^{B}}\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2448em;vertical-align:-0.3948em"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mord mathnormal">s</span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4413em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em"><span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">p</span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4413em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3948em"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size1">)</span></span></span></span></span></span></span></span> is a <code>secp256k1</code> key pair which the BEEFY authority node <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">{\mathcal{{P}}}_{{j}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em">P</span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> uses to sign the BEEFY signed commitments (justifications).
</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-beefy-merkle-mountain-ranges">6.7.4. Merkle Mountain Ranges<a href="#id-beefy-merkle-mountain-ranges" class="hash-link" aria-label="Direct link to 6.7.4. Merkle Mountain Ranges" title="Direct link to 6.7.4. Merkle Mountain Ranges">​</a></h3><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-mmr">Definition 96. Merkle Mountain Ranges<a href="#defn-mmr" class="hash-link" aria-label="Direct link to Definition 96. Merkle Mountain Ranges" title="Direct link to Definition 96. Merkle Mountain Ranges">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>Merkle Mountain Ranges, <strong>MMR</strong>, are used as an efficient way to send block headers and signatures to light clients. Merkle Mountain Ranges (<code>MMR</code>) is an improvement of the traditional Merkle tree data structure. Just like a Merkle tree, an <code>MMR</code> is a binary tree where each leaf node represents a data element and each non-leaf node is the hash of its child nodes. The key difference between a traditional Merkle tree and a MMR lies in the way nodes are organized. In traditional Merkle trees, whenever a leaf node is appended or removed, the tree must be rebuilt and the hashes of the non-leaf nodes must be recalculated. The overhead of recomputing the hashes up to the root makes traditional Merkle unsuitable for handling dynamic data. The <code>MMR</code> is designed to optimize the appending and removal of elements without requiring a complete rebuild of the tree, which makes it more efficient to handle growing lists of leaf nodes.</p><p>MMR structure </p><p>A <code>MMR</code> structure can be seen as a list of perfectly balanced binary sub-trees in descending order of height. It is a strictly append-only structure where nodes are added from left to right, such that a parent node is added as soon as two children exist. The following representation shows a <code>MMR</code> with 11 elements, 7 leaf nodes and 4 non-leaf nodes, where the value of each node corresponds to the order in which it was inserted into the tree.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">       7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      / \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /   \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /     \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   3       6        10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  / \     / \       / \   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> /   \   /   \     /   \   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1     2 4     5   8     9    11</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><div class="alert alert--definition"><h5></h5><div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-mmr-root">Definition 97. Merkle Mountain Ranges root (MMR-root)<a href="#defn-mmr-root" class="hash-link" aria-label="Direct link to Definition 97. Merkle Mountain Ranges root (MMR-root)" title="Direct link to Definition 97. Merkle Mountain Ranges root (MMR-root)">​</a></h6><p>An <code>MMR</code> does not have a single <code>root</code> by design, as a conventional Merkle tree. Every sub-tree has a separate sub-root, which we refer to as the <code>peak</code> of the sub-tree.
Bagging the peaks is the process used for hashing the peaks in order to compute the <code>MMR-root</code>. It is important to define the order in which the peaks are hashed to ensure that a given sub-set of peaks will always derive a unique <code>MMR-root</code>. Here we state that peaks are merged from right to left and bagged via <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo separator="true">,</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">hash(right, left)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>.</p><p>Therefore, given an MMR tree with n peaks ordered in decreasing order of height, the <code>MMR-root</code> of the tree is calculated as follows.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mtext mathvariant="monospace">MMR</mtext><mtext> </mtext><mtext mathvariant="monospace">root</mtext></mrow><mo>=</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mn>1</mn></msub><mo>+</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mn>2</mn></msub><mo>+</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mn>3</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>n</mi></msub><mo>−</mo><mn>1</mn><mo>+</mo><msub><mi>p</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\texttt{MMR root} = hash (p_1 + hash( p_2 + hash( p_3 +... + hash ( p_n-1 + p_n ))))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6111em"></span><span class="mord text"><span class="mord texttt">MMR root</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord">...</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">))))</span></span></span></span></span></div><p><strong>where</strong></p><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>p</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">p_1, p_2,...,p_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>: represents the list of current peaks in decreasing order of heights.</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">hash</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">ha</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span></span></span></span></span>: corresponds to the 256-bit <a href="/chap-host-api#sect-finality#id-ext_hashing_keccak_256">Keccak</a> hash function used to merge the peaks.</li></ul></div></div><p>A distinguished feature of this process is that whenever new leaf nodes are added to the tree, the earlier hash computations of peaks are reused, making new leaf nodes less expensive to insert and to prove (i.e., to verify the integrity of leaf data). </p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-mmr-operations">Definition 98. MMR operations<a href="#defn-mmr-operations" class="hash-link" aria-label="Direct link to Definition 98. MMR operations" title="Direct link to Definition 98. MMR operations">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>Here are the basic operations we should be able to perform on the MMR:</p><ul><li><p>Append Leaf Node (appendData):</p><ul><li>Signature: append(data: T) -&gt; None</li><li>Description: appends a new leaf element with the provided data to the MMR.
</li></ul></li><li><p>Create MMR root (bagPeaks):</p><ul><li>Signature: baggingPeaks(peaksIndexes: List<!-- -->[int]<!-- -->) -&gt; str</li><li>Description: creates the single MMR root based on the list of peaks, and returns the hash string of the  MMR root corresponding to the current state of the tree. </li></ul></li><li><p>Verify Node (verifyProof):</p><ul><li>Signature: verifyNode(nodeHash: str, requiredProofNodes: List<!-- -->[str]<!-- -->, MMRroot: str) -&gt; bool</li><li>Description: verifies if the given node hash can be proved based on the list of required proof nodes and the MMR root hash.</li></ul></li></ul></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-beefy-payload">Definition 99. Payload<a href="#defn-beefy-payload" class="hash-link" aria-label="Direct link to Definition 99. Payload" title="Direct link to Definition 99. Payload">​</a></h6><div class="alert alert--definition"><h5></h5><div><p><strong>Payload:</strong> is the Merkle root of the MMR generated where the leaf data contains the following fields for each block:</p><ul><li><em>LeafVersion</em>: a byte indicating the current version number of the Leaf Format. The first 3 bits are for major versions and the last 5 bits are for minor versions. </li><li><em>BeefyNextAuthoritySetInfo</em>: It is a tuple consisting of:<ul><li>ValidatorSetID</li><li>Len (u32): length of the validator set</li><li>Merkle Root of the list of Next Beefy Authority Set (ECDSA public keys). The exact format depends on the implementation.  </li></ul></li><li>Parent Block number and Parent Block Hash.</li><li>Extra Leaf Data: Currently the Merkle root of the list of (ParaID, ParaHeads)</li></ul></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-beefy-Commitment">Definition 100. Signed Commitment<a href="#defn-beefy-Commitment" class="hash-link" aria-label="Direct link to Definition 100. Signed Commitment" title="Direct link to Definition 100. Signed Commitment">​</a></h6><div class="alert alert--definition"><h5></h5><div><p><strong>Signed Commitment:</strong>
<code>commitment</code> is a tuple of <code>(payload, Block Number, ValidatorSetID)</code>. A <code>signed commitment</code> is a tuple <code>(commitment, signatures)</code>, where <code>signatures</code> is a list of optional signatures of the validator set on the SCALE encoded <code>commitment</code>. Note that the number of signatures in <code>signatures</code> may be less than the length of the Validator Set. </p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-beefy-witness-data">Definition 101. Witness Data<a href="#defn-beefy-witness-data" class="hash-link" aria-label="Direct link to Definition 101. Witness Data" title="Direct link to Definition 101. Witness Data">​</a></h6><div class="alert alert--definition"><h5></h5><div><p><strong>Signed Commitment Witnesses</strong> contains the commitment and an array indicating which validator of the Polkadot network voted for the payload (but not the signatures themselves). The indicators of which validator voted for the payload are just claims and provide no proof. It also contains the signature of one validator on the commitment, which is used only by the subsampling-based Light Clients. The network message is defined in <a href="/chap-networking#defn-grandpa-beefy-signed-commitment-witness">Definition 58</a> and the relayer saves it on the chain of the remote network.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-beefy-light-client">Definition 102. Light Client<a href="#defn-beefy-light-client" class="hash-link" aria-label="Direct link to Definition 102. Light Client" title="Direct link to Definition 102. Light Client">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>A <strong>light client</strong> is an abstract entity in a remote network such as Ethereum. It can be a node or a smart contract with the intent of requesting finality proofs from the Polkadot network. A light client reads the witness data (<a href="/sect-finality#defn-beefy-witness-data">Definition 101</a> from the chain, then requests the signatures directly from the relayer in order to verify those.</p></div></div><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-beefy-relayer">Definition 103. Relayer<a href="#defn-beefy-relayer" class="hash-link" aria-label="Direct link to Definition 103. Relayer" title="Direct link to Definition 103. Relayer">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>A <strong>relayer</strong> (or &quot;prover&quot;) is an abstract entity that takes finality proofs from the Polkadot network and makes those available to the light clients. The relayer attempts to convince the light clients that the finality proofs have been voted for by the Polkadot relay chain validators. The relayer operates off-chain and can for example be a node or a collection of nodes.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-voting-on-payloads">6.7.5. Voting on Payloads<a href="#id-voting-on-payloads" class="hash-link" aria-label="Direct link to 6.7.5. Voting on Payloads" title="Direct link to 6.7.5. Voting on Payloads">​</a></h3><p>The Polkadot Host signs the MMR payload (<a href="/sect-finality#defn-beefy-payload">Definition 99</a>) and gossips it as part of a vote (<a href="/chap-networking#defn-msg-beefy-gossip">Definition 56</a>) to its peers on every new finalized block. The Polkadot Host uses ECDSA for signing the payload since Ethereum has better compatibility for it compared to SR25519 or ED25519.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sect-beefy-committing-witnesses">6.7.6. Committing Witnesses<a href="#sect-beefy-committing-witnesses" class="hash-link" aria-label="Direct link to 6.7.6. Committing Witnesses" title="Direct link to 6.7.6. Committing Witnesses">​</a></h3><p>The relayer (<a href="/sect-finality#defn-beefy-relayer">Definition 103</a>) participates in the Polkadot network by collecting the gossiped votes (<a href="/chap-networking#defn-msg-beefy-gossip">Definition 56</a>). Those votes are converted into the witness data structure (<a href="/sect-finality#defn-beefy-witness-data">Definition 101</a>). The relayer saves the data on the chain of the remote network. The occurrence of saving witnesses on remote networks is undefined.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-requesting-signed-commitments">6.7.7. Requesting Signed Commitments<a href="#id-requesting-signed-commitments" class="hash-link" aria-label="Direct link to 6.7.7. Requesting Signed Commitments" title="Direct link to 6.7.7. Requesting Signed Commitments">​</a></h3><p>A light client (<a href="/sect-finality#defn-beefy-light-client">Definition 102</a>) fetches the Signed Commitment Witness (<a href="/sect-finality#defn-beefy-witness-data">Definition 101</a>) from the chain. Once the light client knows which validators apparently voted for the specified payload, it needs to request the signatures from the relayer to verify whether the claims are actually true. This is achieved by requesting signed commitments (<a href="/chap-networking#defn-grandpa-beefy-signed-commitment">Definition 57</a>).</p><p>How those signed commitments are requested by the light client and delivered by the relayer varies among networks or implementations.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-consensus-message-beefy">Definition 104. BEEFY Consensus Message<a href="#defn-consensus-message-beefy" class="hash-link" aria-label="Direct link to Definition 104. BEEFY Consensus Message" title="Direct link to Definition 104. BEEFY Consensus Message">​</a></h6><div class="alert alert--definition"><h5></h5><div><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>CM</mtext><mrow><mi>b</mi><mi>e</mi><mi>e</mi><mi>f</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\text{CM}_{{beefy}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord text"><span class="mord">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">ee</span><span class="mord mathnormal mtight" style="margin-right:0.10764em">f</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span>, the consensus message for BEEFY, is of the following format:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>CM</mtext><mrow><mi>b</mi><mi>e</mi><mi>e</mi><mi>f</mi><mi>y</mi></mrow></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo fence="true">(</mo><msub><mi>V</mi><mi>B</mi></msub><mo separator="true">,</mo><msub><mi>V</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mi>i</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>R</mi></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{CM}_{{beefy}}={\left\lbrace\begin{matrix}{1}&amp;{\left({V}_{{B}},{V}_{{i}}\right)}\\{2}&amp;{A}_{{i}}\\{3}&amp;{R}\end{matrix}\right.}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord text"><span class="mord">CM</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">ee</span><span class="mord mathnormal mtight" style="margin-right:0.10764em">f</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-2.5em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.492em"><span class="pstrut" style="height:3.15em"></span><span style="height:0.016em;width:0.8889em"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewBox="0 0 888.89 16" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"></path></svg></span></span><span style="top:-3.15em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em"><span class="pstrut" style="height:3.15em"></span><span style="height:0.016em;width:0.8889em"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.016em" style="width:0.8889em" viewBox="0 0 888.89 16" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V16 H384z M384 0 H504 V16 H384z"></path></svg></span></span><span style="top:-4.3em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">1</span></span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">2</span></span></span></span><span style="top:-1.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em"><span style="top:-4.21em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em">)</span></span></span></span></span><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></span></div><p><strong>where</strong></p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>1</td><td>implies that the remote <strong>authorities have changed</strong>. <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">{V}_{{B}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is the array of the new BEEFY authorities’s public keys and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{V}_{{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> is the identifier of the remote validator set.</td></tr><tr><td>2</td><td>implies <strong>on disabled</strong>: an index to the individual authority in <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">{V}_{{B}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em">B</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> that should be immediately disabled until the next authority change.</td></tr><tr><td>3</td><td>implies <strong>MMR root</strong>: a 32-byte array containing the MMR root payload.</td></tr></tbody></table></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-consensus-mechanism-beefy-1">6.7.8. Consensus Mechanism<a href="#id-consensus-mechanism-beefy-1" class="hash-link" aria-label="Direct link to 6.7.8. Consensus Mechanism" title="Direct link to 6.7.8. Consensus Mechanism">​</a></h3><p>Role of various Actors in BEEFY:</p><ul><li><p>Validators are expected to additionally:</p><ol><li>Produce &amp; broadcast vote for the current round.</li></ol></li><li><p>Regular nodes perform the following tasks:</p><ol><li>Receive &amp; validate votes for the current round and broadcast them to their peers.</li><li>Receive &amp; validate BEEFY Justifications and broadcast them to their peers.</li><li>Return BEEFY Justifications for <strong>Mandatory Blocks</strong> on demand.</li><li>Optionally return BEEFY Justifications for non-mandatory blocks on demand.</li></ol></li></ul><p>A <strong>round</strong> is an attempt by BEEFY validators to produce a BEEFY Justification. <strong>Round number</strong> is simply defined as a block number the validators are voting for, or to be more precise, the Commitment for that block number. Round ends when the next round is started, which may happen when one of the events occur:</p><ol><li>Either the node collects <code>2/3rd + 1</code> valid votes for that round.</li><li>Or the node receives a BEEFY Justification for a block greater than the current best BEEFY block.</li></ol><p>In both cases the node proceeds to determine the new round number using &quot;Round Selection&quot;
procedure.</p><p>Both kinds of actors are expected to fully participate in the protocol ONLY IF they believe they are up-to-date with the rest of the network, i.e. they are fully synced. Before this happens, the node should continue processing imported BEEFY Justifications and votes without actively voting themselves.</p><p><strong>Round Selection</strong></p><p>Every node (both regular nodes and validators) determines locally what it believes
the current round number is. The choice is based on their knowledge of:</p><ol><li>Best GRANDPA finalized block number (<code>best_grandpa</code>).</li><li>Best BEEFY finalized block number (<code>best_beefy</code>).</li><li>Starting block of the current session (<code>session_start</code>).</li></ol><p><strong>Session</strong> means a period of time (or rather a number of blocks) where the validator set (keys) does not change. Session are synonymous to epochs (<a href="/sect-block-production#defn-epoch-slot">Definition 59</a>). Since the BEEFY authority set is the same as the GRANDPA authority set for any GRANDPA finalized block, the session boundaries for BEEFY are exactly the same as the ones for GRANDPA.</p><p>We define two kinds of blocks from the perspective of the BEEFY protocol:</p><ol><li><strong>Mandatory Blocks</strong></li><li><strong>Non-mandatory Blocks</strong></li></ol><p>Mandatory blocks are the ones that MUST have BEEFY justification. That means that the validators
will always start and conclude a round at mandatory blocks. For non-mandatory blocks, there may
or may not be a justification and validators may never choose these blocks to start a round.</p><p>Every <strong>first block in</strong> each <strong>session</strong> is considered a <strong>mandatory block</strong>. All other blocks
in the session are non-mandatory, however validators are encouraged to finalize as many blocks as
possible to enable lower latency for light clients and hence end users. Since GRANDPA is
considering session boundary blocks as mandatory as well, <code>session_start</code> block will always have
both GRANDPA and BEEFY Justification.</p><h6 class="anchor anchorWithStickyNavbar_LWe7" id="defn-beefy-round-number">Definition 105. BEEFY Round NUmber<a href="#defn-beefy-round-number" class="hash-link" aria-label="Direct link to Definition 105. BEEFY Round NUmber" title="Direct link to Definition 105. BEEFY Round NUmber">​</a></h6><div class="alert alert--definition"><h5></h5><div><p>The formula for determining the current round number is defined as:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">round_number =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (1 - M) * session_start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   +        M * Minimum(next_session_start, (best_beefy + NEXT_POWER_OF_TWO((best_grandpa - best_beefy + 1) / 2)))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>where:</p><ul><li><code>M</code> is <code>1</code> if the mandatory block in the current session is already finalized and <code>0</code> otherwise.</li><li><code>NEXT_POWER_OF_TWO(x)</code> returns the smallest number greater or equal to <code>x</code> that is a power of two.</li></ul></div></div><p>Intuitively, the next round number should be the oldest mandatory block without a justification,
or the highest GRANDPA-finalized block, whose block number difference with <code>best_beefy</code> block is
a power of two. The mental model for round selection is to first finalize the mandatory block and
then to attempt to pick a block taking into account how fast BEEFY catches up with GRANDPA.
In case GRANDPA makes progress, but BEEFY seems to be lagging behind, validators are changing
rounds less often to increase the chance of concluding them.</p><p>As mentioned earlier, every time the node picks a new <code>round_number</code> (and the validator casts a vote)
it ends the previous one, no matter if finality was reached (i.e. the round concluded) or not.
Votes for an inactive round should not be propagated.</p><p>Note that since BEEFY only votes for GRANDPA-finalized blocks, <code>session_start</code> here actually means:
&quot;the latest session for which the start of is GRANDPA-finalized&quot;, i.e. block production might
have already progressed, but BEEFY needs to first finalize the mandatory block of the older
session.</p><p>While it is useful to finalize non-mandatory blocks frequently, in good networking conditions BEEFY may end up finalizing each and every block GRANDPA finalized block. Practically, with short block times, it&#x27;s going to be rare and might be excessive, so
it&#x27;s suggested for implementations to introduce a <code>min_delta</code> parameter which will limit the frequency with which new rounds are started. The affected component of the formula would be:
<code>best_beefy + MAX(min_delta, NEXT_POWER_OF_TWO(...))</code>, so we start a new round only if the
the power-of-two component is greater than the min delta. Note that if <code>round_number &gt; best_grandpa</code> the validators are not expected to start any round.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-light-client-beefy-1">6.7.9. BEEFY Light Client<a href="#id-light-client-beefy-1" class="hash-link" aria-label="Direct link to 6.7.9. BEEFY Light Client" title="Direct link to 6.7.9. BEEFY Light Client">​</a></h3><p>A light client following BEEFY could request <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi mathvariant="normal">/</mi><mn>3</mn><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N/3 +1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mord">/3</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span> signatures to be checked, where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span> is the number of validators on Polkadot. Assuming a maximum of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">N/3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mord">/3</span></span></span></span></span> malicious validators, the light client can be certain of the payloads finality if all the signatures it requested are valid. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-subsampling-light-client-beefy-1">6.7.10. Subsampling Light Client<a href="#id-subsampling-light-client-beefy-1" class="hash-link" aria-label="Direct link to 6.7.10. Subsampling Light Client" title="Direct link to 6.7.10. Subsampling Light Client">​</a></h3><p>It is an interactive protocol between the light-client (verifier) and the relayer (prover) to convince the Light Client with a high probability that the payload sent by the prover is signed by honest Polkadot validators. The protocol prioritizes efficiency and tries to minimize the number (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mo>&lt;</mo><mi>N</mi><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">&lt;&lt; N/3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em"></span><span class="mrel">&lt;&lt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mord">/3</span></span></span></span></span>) of signature checks (computationally expensive operations) on the light client side. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-APK-light-client-beefy-1">6.7.11. APK Proof based Light Clients<a href="#id-APK-light-client-beefy-1" class="hash-link" aria-label="Direct link to 6.7.11. APK Proof based Light Clients" title="Direct link to 6.7.11. APK Proof based Light Clients">​</a></h3><p>TODO: Section on using Aggregatable Signatures for efficient verification on light clients.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/w3f/polkadot-spec/blob/main/docs/sect-finality.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/sect-block-production"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">5. Block Production</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/sect-lightclient"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">7. Light Clients</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#id-introduction-4" class="table-of-contents__link toc-highlight">6.1. Introduction</a></li><li><a href="#id-initiating-the-grandpa-state" class="table-of-contents__link toc-highlight">6.2. Initiating the GRANDPA State</a><ul><li><a href="#id-voter-set-changes" class="table-of-contents__link toc-highlight">6.2.1. Voter Set Changes</a></li></ul></li><li><a href="#id-rejoining-the-same-voter-set" class="table-of-contents__link toc-highlight">6.3. Rejoining the Same Voter Set</a></li><li><a href="#id-voting-process-in-round-r" class="table-of-contents__link toc-highlight">6.4. Voting Process in Round {r}</a></li><li><a href="#sect-finality-forced-changes" class="table-of-contents__link toc-highlight">6.5. Forced Authority Set Changes</a></li><li><a href="#sect-block-finalization" class="table-of-contents__link toc-highlight">6.6. Block Finalization</a><ul><li><a href="#sect-grandpa-catchup" class="table-of-contents__link toc-highlight">6.6.1. Catching up</a></li></ul></li><li><a href="#sect-grandpa-beefy" class="table-of-contents__link toc-highlight">6.7. Bridge design (BEEFY)</a><ul><li><a href="#id-motivation-beefy-1" class="table-of-contents__link toc-highlight">6.7.1. Motivation</a></li><li><a href="#id-overview-beefy-1" class="table-of-contents__link toc-highlight">6.7.2. Protocol Overview</a></li><li><a href="#id-preliminaries-2" class="table-of-contents__link toc-highlight">6.7.3. Preliminaries</a></li><li><a href="#id-beefy-merkle-mountain-ranges" class="table-of-contents__link toc-highlight">6.7.4. Merkle Mountain Ranges</a></li><li><a href="#id-voting-on-payloads" class="table-of-contents__link toc-highlight">6.7.5. Voting on Payloads</a></li><li><a href="#sect-beefy-committing-witnesses" class="table-of-contents__link toc-highlight">6.7.6. Committing Witnesses</a></li><li><a href="#id-requesting-signed-commitments" class="table-of-contents__link toc-highlight">6.7.7. Requesting Signed Commitments</a></li><li><a href="#id-consensus-mechanism-beefy-1" class="table-of-contents__link toc-highlight">6.7.8. Consensus Mechanism</a></li><li><a href="#id-light-client-beefy-1" class="table-of-contents__link toc-highlight">6.7.9. BEEFY Light Client</a></li><li><a href="#id-subsampling-light-client-beefy-1" class="table-of-contents__link toc-highlight">6.7.10. Subsampling Light Client</a></li><li><a href="#id-APK-light-client-beefy-1" class="table-of-contents__link toc-highlight">6.7.11. APK Proof based Light Clients</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More Info</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/w3f/polkadot-spec" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://web3.foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/Support Docs/privacy_policy">Privacy Policy</a></li><li class="footer__item"><a href="https://web3.foundation/legal-disclosures/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Legal Disclosures</a></li></ul></div><div class="col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/Web3foundation" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2024 Web3 Foundation</div></div></div></footer></div>
<script>!function(){var t,n;t=history.pushState,n=history.replaceState,history.pushState=function(){t.apply(history,arguments),window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange"))},history.replaceState=function(){n.apply(history,arguments),window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange"))},window.addEventListener("popstate",(function(){window.dispatchEvent(new Event("locationchange"))}))}()</script>
<script>!function(n,i){var t="",a="",e=function(){(a=window.location.href.split("#")[0])!==t&&(t=a,setTimeout(n,500))};window.addEventListener("load",e),window.addEventListener("locationchange",e)}((function(){document.querySelectorAll("svg.graphviz").forEach((function(n){if(!n.classList.contains("fixed")){var i=n.firstElementChild.querySelector("path");i&&i.remove();var t=Array.from(n.children).reduce((function(n,i){var t=i.getBBox(),a=t.x,e=t.y,o=t.width,c=t.height;return(!n.xMin||a<n.xMin)&&(n.xMin=a),(!n.xMax||a+o>n.xMax)&&(n.xMax=a+o),(!n.yMin||e<n.yMin)&&(n.yMin=e),(!n.yMax||e+c>n.yMax)&&(n.yMax=e+c),n}),{xMin:0,xMax:0,yMin:0,yMax:0}),a=t.xMin,e=t.xMax,o=t.yMin,c=t.yMax,x="".concat(a," ").concat(o," ").concat(e-a," ").concat(c-o);n.setAttribute("viewBox",x),n.classList.add("fixed")}}))}))</script>
<script>!function(n,e){var t="",a="",i=function(){(a=window.location.href.split("#")[0])!==t&&(t=a,setTimeout(n,500))};window.addEventListener("load",i),window.addEventListener("locationchange",i)}((function(){for(var n=document.getElementsByClassName("csl-right-inline"),e=0;e<n.length;e++){var t=n[e],a=t.innerHTML;a=a.replace(/(?<!href="|<a href=")(https?:\/\/[^\s]+)(?<!:)/g,'<a href="$1" target="_blank">$1</a>'),t.innerHTML=a}}))</script>
<script>!function(e,n){var a="",i="",o=function(){(i=window.location.href.split("#")[0])!==a&&(a=i,setTimeout(e,500))};window.addEventListener("load",o),window.addEventListener("locationchange",o)}((function(){var e,n=null===(e=document.getElementsByClassName("theme-doc-markdown markdown")[0])||void 0===e?void 0:e.children;if(n&&"H1"===n[0].children[0].tagName&&n[0].children[0].innerHTML.toLowerCase().includes("glossary"))for(var a=0;a<n.length;a++)"P"===n[a].tagName&&n[a].classList.add("glossary-term"),"UL"===n[a].tagName&&n[a].classList.add("glossary-definition")}))</script>
<script>!function(n,e){var t="",o="",i=function(){(o=window.location.href.split("#")[0])!==t&&(t=o,setTimeout(n,500))};window.addEventListener("load",i),window.addEventListener("locationchange",i)}((function(){for(var n=document.getElementsByClassName("ps-keyword"),e=0;e<n.length;e++){var t=n[e],o=t.innerHTML;o=o.replace(/(\d+)/g,""),t.innerHTML=o}}))</script>

<script>!function(){var t="https://spec.polkadot.network/";fetch("/entitiesMap.json").then((function(n){return n.text().then((function(n){var o=JSON.parse(n),c=window.location.href;if(c.startsWith("".concat(t,"#"))){var a=c.split("#")[1],e=o[a];e&&window.location.replace("".concat(t).concat(e,"#").concat(a))}}))}))}()</script>
<script>!function(e,n){var a="",t="",i=function(){(t=window.location.href.split("#")[0])!==a&&(a=t,setTimeout(e,0))};window.addEventListener("load",i),window.addEventListener("locationchange",i)}((function(){var e=document.getElementsByClassName("breadcrumbs")[0];if(e){var n=e.children[1].children[0],a=("A"===n.tagName?n.children[0]:n).innerHTML,t=document.getElementsByClassName("navbar__items--right")[0].querySelectorAll('a[aria-current="page"]'),i="navbar__link--active";t.forEach((function(e){e.innerHTML!=a?e.classList.remove(i):e.classList.contains(i)||e.classList.add(i)}))}}))</script></body>
</html>